<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accounting Cycle Summative Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <style>
        /* Times New Roman Font Application */
        body {
            font-family: 'Times New Roman', Times, serif;
            background-color: #f4f6f8;
        }
        
        /* Custom style to lock scrolling */
        .no-scroll {
            overflow: hidden;
            height: 100vh; 
        }

        /* Class for the printed PDF output only */
        .print-layout {
            font-family: 'Times New Roman', Times, serif;
            font-size: 11pt;
            padding: 0.5in;
            background: white;
            position: relative;
            min-height: 100%;
        }
        
        /* PDF-specific styling for correct/incorrect */
        .feedback-correct {
            background-color: #f0fdf4; /* green-50 */
            border: 1px solid #bbf7d0; /* green-200 */
            border-radius: 0.5rem;
            padding: 0.5rem;
            margin-top: 5px;
        }
        .feedback-incorrect {
            background-color: #fef2f2; /* red-50 */
            border: 1px solid #fecaca; /* red-200 */
            border-radius: 0.5rem;
            padding: 0.5rem;
            margin-top: 5px;
        }

        /* Question Palette Styles */
        .q-dot {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            border: 2px solid #e5e7eb;
            transition: all 0.2s;
            font-family: 'Inter', sans-serif; /* Keep UI elements legible */
        }
        .q-dot.active {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        .q-dot.answered {
            background-color: #dcfce7; /* green-100 */
            border-color: #22c55e; /* green-500 */
            color: #166534;
        }
        .q-dot.active.answered {
            background-color: #15803d; /* green-700 */
            color: white;
        }
        
        /* Print Specific Utilities */
        .print-rubric {
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: #000;
        }

        /* Footer Styling */
        .print-footer {
            margin-top: 30px;
            padding-top: 10px;
            border-top: 1px solid #000;
            width: 100%;
            font-family: 'Times New Roman', Times, serif;
        }
        
        .footer-line-1 {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-weight: bold;
            font-size: 10pt;
        }

        .footer-line-2 {
            display: flex;
            justify-content: center;
            margin-top: 5px;
        }

        .footer-box {
            border: 1px solid #000;
            padding: 2px 10px;
            font-style: italic;
            font-size: 9pt;
            text-align: center;
        }

        /* Loader */
        .loader {
            border: 4px solid #f3f3f3;
            border-radius: 50%;
            border-top: 4px solid #3498db;
            width: 20px;
            height: 20px;
            -webkit-animation: spin 2s linear infinite; /* Safari */
            animation: spin 2s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-left: 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

    </style>
</head>
<body class="min-h-screen antialiased no-scroll relative">

    <!-- SECURITY OVERLAY -->
    <div id="security-overlay" class="fixed inset-0 bg-gray-900 z-[60] flex items-center justify-center text-white p-6 text-center">
        <div>
            <h1 class="text-3xl font-bold mb-4 text-red-500">Access Denied</h1>
            <p id="security-msg" class="text-xl">Validating link parameters...</p>
        </div>
    </div>

    <!-- TIMER OVERLAY (Sticky Header) -->
    <div id="timer-bar" class="hidden fixed top-0 left-0 w-full bg-red-600 text-white z-50 px-4 py-2 shadow-md flex justify-between items-center">
        <span class="font-bold font-serif text-lg">TIME REMAINING</span>
        <span id="timer-display" class="font-mono text-2xl font-bold">00:00:00</span>
    </div>

    <div id="app" class="max-w-5xl mx-auto p-4 md:p-6 pt-16">

        <!-- Student Info Section (Locks the rest of the app) -->
        <section id="student-info-section" class="hidden bg-white p-8 rounded-xl shadow-2xl mb-6 border-t-8 border-blue-800 max-w-2xl mx-auto mt-10">
            
            <!-- Logo -->
            <div class="flex justify-center mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-24 w-24 text-blue-900">
                    <path d="M11.7 2.805a.75.75 0 01.6 0A60.65 60.65 0 0122.83 8.72a.75.75 0 01-.231 1.337 49.949 49.949 0 00-9.902 3.912l-.003.002-.34.18a.75.75 0 01-.707 0A50.009 50.009 0 001.402 10.06a.75.75 0 01-.231-1.337A60.653 60.653 0 0111.7 2.805z" />
                    <path d="M13.06 15.473a48.45 48.45 0 017.666-3.282c.134 1.414.22 2.843.255 4.286a.75.75 0 01-.46.71 47.878 47.878 0 00-8.105 4.342.75.75 0 01-.832 0 47.877 47.877 0 00-8.104-4.342.75.75 0 01-.461-.71c.035-1.442.121-2.87.255-4.286A48.4 48.4 0 0110.94 15.473a.75.75 0 001.06 0z" />
                    <path d="M4.75 17.25a.75.75 0 01.75.75v2.25c0 .138.112.25.25.25h2.5a.75.75 0 010 1.5h-2.5a1.75 1.75 0 01-1.75-1.75v-2.25a.75.75 0 01.75-.75z" />
                </svg>
            </div>

            <h2 class="text-3xl font-extrabold text-gray-800 mb-2 text-center font-serif">SUMMATIVE TEST</h2>
            <p class="text-center text-gray-500 mb-8 font-serif italic">Accounting Cycle Mastery</p>
            
            <div class="space-y-4">
                <!-- Firebase Attendance Check Section -->
                <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                    <h3 class="text-blue-800 font-bold mb-3 border-b border-blue-200 pb-1">Attendance Verification</h3>
                    <div class="grid grid-cols-1 md:grid-cols-1 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">ID Number</label>
                            <input type="text" id="id-number" placeholder="Enter your Student ID" class="w-full p-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <!-- Hidden input to store attendance ID from URL -->
                        <input type="hidden" id="attendance-record">
                    </div>
                    <button onclick="window.checkAttendance()" class="mt-3 w-full py-2 bg-blue-600 text-white text-sm font-bold rounded hover:bg-blue-700 transition flex justify-center items-center">
                        Verify ID & Load Data <span id="loading-spinner" class="loader hidden"></span>
                    </button>
                    <p id="firebase-msg" class="text-xs mt-2 text-center min-h-[1rem]"></p>
                </div>

                <!-- Auto-populated Fields (Read Only to prevent tampering) -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Class Number</label>
                        <input type="number" id="class-number" class="w-full p-3 border border-gray-300 rounded-lg bg-gray-50" readonly>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Grade Level & Section</label>
                        <input type="text" id="grade-section" class="w-full p-3 border border-gray-300 rounded-lg bg-gray-50" readonly>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                    <input type="text" id="full-name" class="w-full p-3 border border-gray-300 rounded-lg bg-gray-50" readonly>
                </div>
            </div>

            <button id="btn-start-exam" onclick="window.initializeTest()" class="mt-8 w-full px-4 py-3 bg-gray-400 text-white font-bold text-lg rounded-lg shadow-lg cursor-not-allowed font-serif" disabled>
                Start Examination
            </button>
        </section>

        <!-- Main Test Interface (Hidden initially) -->
        <div id="main-interface" class="hidden">
            
            <!-- Header -->
            <header class="bg-white shadow-lg rounded-xl mb-6 overflow-hidden">
                <div class="bg-blue-900 text-white p-4 flex justify-between items-center">
                    <div>
                        <h1 class="text-xl font-bold font-serif">SUMMATIVE TEST</h1>
                        <p class="text-xs text-blue-200 font-serif" id="student-display-name">Student Name</p>
                    </div>
                    <div class="text-right">
                        <!-- MODIFIED: Directly calls finishAndPreview() which now handles auto-submit flow -->
                        <button onclick="window.finishAndPreview()" class="bg-green-500 hover:bg-green-600 text-white text-sm font-bold py-2 px-4 rounded shadow font-serif">
                            Submit & Print Results
                        </button>
                    </div>
                </div>

                <!-- Tabs -->
                <nav class="flex overflow-x-auto bg-gray-50 border-b border-gray-200">
                    <button onclick="window.switchTestPart(1)" id="tab-1" class="flex-1 py-4 px-6 text-sm font-bold text-gray-500 hover:text-blue-800 border-b-4 border-transparent hover:border-blue-300 transition-all whitespace-nowrap font-serif">
                        TEST 1: Adjustments
                    </button>
                    <button onclick="window.switchTestPart(2)" id="tab-2" class="flex-1 py-4 px-6 text-sm font-bold text-gray-500 hover:text-blue-800 border-b-4 border-transparent hover:border-blue-300 transition-all whitespace-nowrap font-serif">
                        TEST 2: Worksheet & FS
                    </button>
                    <button onclick="window.switchTestPart(3)" id="tab-3" class="flex-1 py-4 px-6 text-sm font-bold text-gray-500 hover:text-blue-800 border-b-4 border-transparent hover:border-blue-300 transition-all whitespace-nowrap font-serif">
                        TEST 3: Closing & Reversing
                    </button>
                </nav>
            </header>

            <div class="flex flex-col lg:flex-row gap-6">
                
                <!-- Left Column: Question Area -->
                <div class="flex-1">
                    <div id="question-card" class="bg-white p-6 rounded-xl shadow-md min-h-[400px] relative">
                        <!-- Question Content Injected Here -->
                        <div id="question-content"></div>
                        
                        <!-- Navigation Buttons -->
                        <div class="mt-8 flex justify-between items-center pt-4 border-t border-gray-100">
                            <button onclick="window.prevQuestion()" id="btn-prev" class="px-4 py-2 rounded-lg border border-gray-300 text-gray-600 hover:bg-gray-50 font-medium flex items-center font-serif">
                                ‚Üê Previous
                            </button>
                            <span id="question-counter" class="text-sm text-gray-500 font-mono">1 / 25</span>
                            <button onclick="window.nextQuestion()" id="btn-next" class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 font-medium flex items-center font-serif">
                                Next ‚Üí
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Navigation Palette -->
                <div class="w-full lg:w-64 flex-shrink-0">
                    <div class="bg-white p-4 rounded-xl shadow-md">
                        <h3 class="text-sm font-bold text-gray-700 mb-3 uppercase tracking-wider font-serif">Question Navigator</h3>
                        <div id="question-palette" class="grid grid-cols-5 gap-2">
                            <!-- Dots injected via JS -->
                        </div>
                        <div class="mt-4 text-xs text-gray-500 flex flex-col gap-1 font-serif">
                            <div class="flex items-center"><span class="w-3 h-3 rounded-full border border-gray-300 mr-2"></span> Unanswered</div>
                            <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-blue-500 mr-2"></span> Current</div>
                            <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-green-100 border border-green-500 mr-2"></span> Answered</div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Print Preview Modal (Buttons are dynamic now) -->
    <div id="print-preview-modal" class="hidden fixed inset-0 bg-gray-800 bg-opacity-95 z-[70] flex justify-center items-start overflow-y-auto pt-10 pb-10">
        <div class="bg-white w-full max-w-4xl rounded-lg shadow-2xl flex flex-col max-h-[90vh]">
            <div class="p-4 border-b flex justify-between items-center bg-gray-50 rounded-t-lg">
                <h2 class="text-xl font-bold text-gray-800 font-serif">Result Preview</h2>
                <!-- Dynamic Buttons Injected Here -->
                <div class="space-x-2" id="preview-actions"></div>
            </div>
            <div id="print-content" class="p-8 overflow-y-auto print-layout">
                <!-- Report injected here -->
            </div>
        </div>
    </div>

    <!-- Submitting Loader Overlay -->
    <div id="submission-overlay" class="hidden fixed inset-0 bg-white bg-opacity-90 z-[80] flex flex-col items-center justify-center text-blue-900">
        <div class="loader" style="width: 50px; height: 50px; border-width: 6px;"></div>
        <p class="mt-4 text-xl font-bold">Submitting Results to Server...</p>
        <p class="text-sm">Please wait. Do not close this window.</p>
    </div>

    <!-- Use Type Module for Firebase Imports -->
    <script type="module">
        // üîπ FIREBASE SETUP & LOGIC
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAgOsKAZWwExUzupxSNytsfOo9BOppF0ng",
            authDomain: "jlvcpa-quizzes.firebaseapp.com",
            projectId: "jlvcpa-quizzes",
            storageBucket: "jlvcpa-quizzes.appspot.com",
            messagingSenderId: "629158256557",
            appId: "1:629158256557:web:b3d1a424b32e28cd578b24"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // URL PARAMS & SECURITY CHECK
        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            const attendanceId = urlParams.get('att');
            const expiry = urlParams.get('exp');
            const duration = urlParams.get('dur');
            const overlay = document.getElementById('security-overlay');
            const msg = document.getElementById('security-msg');

            if (!attendanceId || !expiry || !duration) {
                msg.innerText = "Invalid Link: Missing parameters.";
                return; 
            }

            const now = new Date().getTime();
            if (now > parseInt(expiry)) {
                msg.innerText = "This quiz link has expired.";
                return;
            }

            // Set values
            document.getElementById('attendance-record').value = attendanceId;
            window.examDurationMins = parseInt(duration);
            
            // Unlock
            overlay.classList.add('hidden');
            document.getElementById('student-info-section').classList.remove('hidden');
        };

        // Check Attendance against Param ID
        window.checkAttendance = async function() {
            const recordId = document.getElementById('attendance-record').value; // From URL
            const idNumber = document.getElementById('id-number').value.trim();
            const msg = document.getElementById('firebase-msg');
            const spinner = document.getElementById('loading-spinner');

            if (!idNumber) {
                msg.innerHTML = "<span class='text-red-600'>Please enter Student ID.</span>";
                return;
            }

            spinner.classList.remove('hidden');
            msg.innerText = "Checking database...";

            try {
                const docRef = doc(db, "attendance", recordId);
                const docSnap = await getDoc(docRef);

                if (docSnap.exists()) {
                    const data = docSnap.data();
                    const studentsArray = data.students;

                    if (Array.isArray(studentsArray)) {
                        const student = studentsArray.find(s => String(s.Idnumber) === String(idNumber));

                        if (student) {
                            const status = student.status || "";
                            if (status.includes("‚úî") || status.includes("‚úì") || status.includes("‚úîÔ∏è")) {
                                const cn = student.CN || "";
                                const name = student.fullName || "";
                                const section = data.section || ""; 

                                document.getElementById('class-number').value = cn;
                                document.getElementById('full-name').value = name;
                                document.getElementById('grade-section').value = section;
                                
                                // Enable Start Button
                                const btn = document.getElementById('btn-start-exam');
                                btn.disabled = false;
                                btn.classList.remove('bg-gray-400', 'cursor-not-allowed');
                                btn.classList.add('bg-blue-800', 'hover:bg-blue-900', 'hover:scale-[1.02]');

                                msg.innerHTML = "<span class='text-green-600 font-bold'>‚úì Student Found & Verified!</span>";
                            } else {
                                msg.innerHTML = `<span class='text-red-600 font-bold'>‚ö† Student is marked absent (Status: ${status}). Login denied.</span>`;
                            }
                        } else {
                            msg.innerHTML = "<span class='text-red-600'>ID Number not found in this attendance record.</span>";
                        }
                    } else {
                         msg.innerHTML = "<span class='text-red-600'>Error: 'students' field is not an array.</span>";
                    }
                } else {
                    msg.innerHTML = "<span class='text-red-600'>Attendance Record not found (Invalid Link).</span>";
                }
            } catch (error) {
                console.error("Firebase Error:", error);
                msg.innerHTML = "<span class='text-red-600'>Connection Error. Please try again.</span>";
            } finally {
                spinner.classList.add('hidden');
            }
        };

        // Save to Firebase
        window.saveResultsToFirebase = async function(resultData) {
            const overlay = document.getElementById('submission-overlay');
            overlay.classList.remove('hidden');

            const attendanceId = document.getElementById('attendance-record').value;
            // Collection: results_T2 Summative Test 01_ATTENDANCE_ID
            const collectionName = `results_T2 Summative Test 01_${attendanceId}`;
            
            const docName = `students.${resultData.studentInfo.cn}-students.${resultData.studentInfo.idNumber}-${resultData.studentInfo.fn}`;

            try {
                // Sanitize data structure before saving
                // Ensure no undefined values exist in the object tree
                const cleanData = JSON.parse(JSON.stringify(resultData, (k, v) => v === undefined ? null : v));
                
                await setDoc(doc(db, collectionName, docName), cleanData);
                return true;
            } catch (error) {
                console.error("Save Error", error);
                alert("Error saving to server: " + error.message);
                overlay.classList.add('hidden');
                return false;
            }
        };

    </script>

    <script>
        // --- DATA SOURCE ---
        // REVISED QUESTIONS: Abbreviations expanded, complete forms used.
        const allQuestionsPool = [
            // --- Original 100 Questions (Steps 5 & 6) ---
            // Adjusting Entries (1-30)
            { id: 1, type: 'Theory', topic: 'Adjustments', q: 'The expense recognition principle dictates that expenses should be recorded:', options: ['When cash is paid.', 'In the period the benefit or service is received.', 'At the end of the year.', 'When the invoice is received.'], a: 'In the period the benefit or service is received.', s: 'This principle (often called the matching principle) ensures that costs are matched with the revenues they helped generate in the same period.' },
            { id: 2, type: 'Theory', topic: 'Adjustments', q: 'Which category of adjusting entry involves cash being received or paid *before* the expense or revenue is recognized?', options: ['Accruals.', 'Deferrals.', 'Corrections.', 'Estimates.'], a: 'Deferrals.', s: 'Deferrals involve the postponement of an expense (Prepaid Expense) or revenue (Unearned Revenue) until the service or benefit is used or provided.' },
            { id: 3, type: 'Theory', topic: 'Adjustments', q: 'An unearned revenue is classified as which type of account?', options: ['An Asset.', 'An Expense.', 'A Liability.', 'A Revenue.'], a: 'A Liability.', s: 'Unearned revenue represents a company\'s obligation to perform a service or deliver a good in the future, thus it is a liability.' },
            { id: 4, type: 'Theory', topic: 'Adjustments', q: 'Accrued Revenue means:', options: ['Revenue has been earned but not yet recorded in the ledger.', 'Cash has been received but the service is not yet performed.', 'Revenue has been recorded but the cash has not been received.', 'Cash has been paid for a future revenue.'], a: 'Revenue has been earned but not yet recorded in the ledger.', s: 'Accrued revenue is revenue recognized before cash is received. The adjusting entry debits an Asset (e.g., Accounts Receivable) and credits a Revenue account.' },
            { id: 5, type: 'Theory', topic: 'Adjustments', q: 'What is the purpose of the Accumulated Depreciation account?', options: ['To record the cash set aside to replace the asset.', 'To show the total amount of depreciation expense recorded on an asset since it was acquired.', 'To record the market value of the asset.', 'To expense the asset in the year of purchase.'], a: 'To show the total amount of depreciation expense recorded on an asset since it was acquired.', s: 'Accumulated Depreciation is a contra-asset account. It offsets the cost of the asset shown in the ledger.' },
            { id: 6, type: 'Theory', topic: 'Adjustments', q: 'The adjusting entry for accrued interest expense involves which two account types?', options: ['Asset and Revenue.', 'Asset and Expense.', 'Liability and Expense.', 'Liability and Revenue.'], a: 'Liability and Expense.', s: 'Debit Interest Expense (Expense) and Credit Interest Payable (Liability).' },
            { id: 7, type: 'Theory', topic: 'Adjustments', q: 'If the adjustment for supplies used is not recorded, what is the effect on the Income Statement?', options: ['Net Income is overstated.', 'Net Income is understated.', 'Expenses are overstated.', 'Revenues are understated.'], a: 'Net Income is overstated.', s: 'Not recording the expense means expenses are understated, leading to an overstated Net Income.' },
            { id: 8, type: 'Theory', topic: 'Adjustments', q: 'Adjusting entries are normally prepared:', options: ['At the beginning of the accounting period.', 'At the end of the accounting period.', 'When cash is paid or received.', 'On a weekly basis.'], a: 'At the end of the accounting period.', s: 'They are period-end adjustments to bring accounts up to date before financial statements are prepared.' },
            { id: 9, type: 'Theory', topic: 'Adjustments', q: 'The book value of a depreciable asset is calculated as:', options: ['Cost minus Salvage Value.', 'Cost minus Accumulated Depreciation.', 'Market Value minus Cost.', 'Original Cost only.'], a: 'Cost minus Accumulated Depreciation.', s: 'Book Value (or Carrying Amount) is the asset\'s cost less the portion that has been expensed (Accumulated Depreciation).' },
            { id: 10, type: 'Theory', topic: 'Adjustments', q: 'Which account balance is typically decreased by an adjusting entry for a prepaid expense?', options: ['An Expense account.', 'A Liability account.', 'An Asset account.', 'A Revenue account.'], a: 'An Asset account.', s: 'The prepaid asset account (e.g., Prepaid Insurance) is credited (decreased) and the corresponding expense is debited (increased).' },
            { id: 11, type: 'Problem', topic: 'Adjustments', q: 'On Jan 1, a company paid ‚Ç±6,000 for a 1-year insurance policy. What is the adjusting entry on Dec 31? (Asset Method)', options: ['Debit Insurance Expense ‚Ç±500; Credit Prepaid Insurance ‚Ç±500.', 'Debit Prepaid Insurance ‚Ç±6,000; Credit Cash ‚Ç±6,000.', 'Debit Insurance Expense ‚Ç±6,000; Credit Prepaid Insurance ‚Ç±6,000.', 'Debit Prepaid Insurance ‚Ç±5,500; Credit Insurance Expense ‚Ç±5,500.'], a: 'Debit Insurance Expense ‚Ç±6,000; Credit Prepaid Insurance ‚Ç±6,000.', s: '(‚Ç±6,000 / 12 months) * 12 months used = ‚Ç±6,000. All prepaid insurance is now expired and must be expensed.' },
            { id: 12, type: 'Problem', topic: 'Adjustments', q: 'The Supplies account has a ‚Ç±2,500 debit balance. A count reveals ‚Ç±700 of supplies on hand. What is the adjustment amount for supplies used?', options: ['‚Ç±700', '‚Ç±1,800', '‚Ç±2,500', '‚Ç±3,200'], a: '‚Ç±1,800', s: 'Used supplies = Beginning Balance (‚Ç±2,500) - Ending Balance (‚Ç±700) = ‚Ç±1,800. Entry: Debit Supplies Expense ‚Ç±1,800, Credit Supplies ‚Ç±1,800.' },
            { id: 13, type: 'Problem', topic: 'Adjustments', q: 'A company borrowed ‚Ç±50,000 at 6% interest on Dec 1. The interest is due on March 1. What is the accrued interest expense on Dec 31?', options: ['‚Ç±0', '‚Ç±250', '‚Ç±750', '‚Ç±3,000'], a: '‚Ç±250', s: '(‚Ç±50,000 * 0.06) * (1/12) = ‚Ç±250. Entry: Debit Interest Expense ‚Ç±250, Credit Interest Payable ‚Ç±250.' },
            { id: 14, type: 'Problem', topic: 'Adjustments', q: 'Depreciation for equipment is calculated to be ‚Ç±900 per month. The adjusting entry is recorded monthly. What is the entry?', options: ['Debit Depreciation Expense ‚Ç±900; Credit Equipment ‚Ç±900.', 'Debit Accumulated Depreciation ‚Ç±900; Credit Depreciation Expense ‚Ç±900.', 'Debit Depreciation Expense ‚Ç±900; Credit Accumulated Depreciation - Equipment ‚Ç±900.', 'Debit Equipment ‚Ç±900; Credit Depreciation Expense ‚Ç±900.'], a: 'Debit Depreciation Expense ‚Ç±900; Credit Accumulated Depreciation - Equipment ‚Ç±900.', s: 'This records the monthly expense and the cumulative reduction in asset value.' },
            { id: 15, type: 'Problem', topic: 'Adjustments', q: 'Unearned Revenue has a balance of ‚Ç±4,000. During the period, ‚Ç±1,500 of the service was completed. What is the adjusting entry? (Liability Method)', options: ['Debit Unearned Revenue ‚Ç±1,500; Credit Service Revenue ‚Ç±1,500.', 'Debit Service Revenue ‚Ç±1,500; Credit Unearned Revenue ‚Ç±1,500.', 'Debit Unearned Revenue ‚Ç±2,500; Credit Service Revenue ‚Ç±2,500.', 'Debit Service Revenue ‚Ç±4,000; Credit Unearned Revenue ‚Ç±4,000.'], a: 'Debit Unearned Revenue ‚Ç±1,500; Credit Service Revenue ‚Ç±1,500.', s: 'The liability is reduced (debited) as the revenue is recognized (credited).' },
            { id: 16, type: 'Problem', topic: 'Adjustments', q: 'Employees earn ‚Ç±800 per day for a 5-day week. The last payday was Friday, Dec 26. Dec 31 is Wednesday. What is the accrued salaries expense?', options: ['‚Ç±800', '‚Ç±1,600', '‚Ç±2,400', '‚Ç±4,000'], a: '‚Ç±2,400', s: 'Dec 29, 30, and 31 (3 days) are unpaid. 3 days * ‚Ç±800/day = ‚Ç±2,400. Entry: Debit Salaries Expense ‚Ç±2,400, Credit Salaries Payable ‚Ç±2,400.' },
            { id: 17, type: 'Problem', topic: 'Adjustments', q: 'A machine cost ‚Ç±45,000, has a salvage value of ‚Ç±5,000, and a useful life of 10 years. Calculate the annual straight-line depreciation.', options: ['‚Ç±4,500', '‚Ç±4,000', '‚Ç±5,000', '‚Ç±500'], a: '‚Ç±4,000', s: '(‚Ç±45,000 - ‚Ç±5,000) / 10 years = ‚Ç±4,000.' },
            { id: 18, type: 'Problem', topic: 'Adjustments', q: 'If Unearned Revenue was initially credited for ‚Ç±10,000, and ‚Ç±3,000 has been earned, what is the post-adjustment balance of Unearned Revenue?', options: ['‚Ç±3,000 Credit', '‚Ç±7,000 Credit', '‚Ç±10,000 Credit', '‚Ç±7,000 Debit'], a: '‚Ç±7,000 Credit', s: '‚Ç±10,000 (initial credit) - ‚Ç±3,000 (debit for adjustment) = ‚Ç±7,000 liability remaining.' },
            { id: 19, type: 'Problem', topic: 'Adjustments', q: 'The company performed ‚Ç±1,200 of services for a client but has not yet billed them. What is the adjusting entry?', options: ['Debit Cash ‚Ç±1,200; Credit Service Revenue ‚Ç±1,200.', 'Debit Accounts Receivable ‚Ç±1,200; Credit Service Revenue ‚Ç±1,200.', 'Debit Service Revenue ‚Ç±1,200; Credit Accounts Receivable ‚Ç±1,200.', 'No entry is needed yet.'], a: 'Debit Accounts Receivable ‚Ç±1,200; Credit Service Revenue ‚Ç±1,200.', s: 'This is accrued revenue; an asset (Accounts Receivable) is increased, and revenue is recognized.' },
            { id: 20, type: 'Problem', topic: 'Adjustments', q: 'Prepaid Rent has a ‚Ç±3,600 balance. The company uses ‚Ç±300 of rent each month. What is the balance of Prepaid Rent after one month\'s adjustment?', options: ['‚Ç±300', '‚Ç±3,300', '‚Ç±3,600', '‚Ç±3,900'], a: '‚Ç±3,300', s: '‚Ç±3,600 - ‚Ç±300 (adjustment) = ‚Ç±3,300. This is the unexpired asset portion remaining.' },
            { id: 21, type: 'Problem', topic: 'Adjustments', q: 'A laptop was purchased on July 1 for ‚Ç±2,400. Useful life is 4 years, no salvage value. What is the depreciation expense on Dec 31 (6 months)?', options: ['‚Ç±200', '‚Ç±300', '‚Ç±600', '‚Ç±2,400'], a: '‚Ç±300', s: 'Annual Depreciation: ‚Ç±2,400 / 4 years = ‚Ç±600. Six months: ‚Ç±600 * (6/12) = ‚Ç±300.' },
            { id: 22, type: 'Problem', topic: 'Adjustments', q: 'If Unearned Revenue is debited and Service Revenue is credited, this adjustment is for:', options: ['An accrual of revenue.', 'A deferral that adjusts a liability to revenue.', 'A deferral that adjusts an asset to an expense.', 'A correction of an error.'], a: 'A deferral that adjusts a liability to revenue.', s: 'It recognizes the portion of the cash received in advance (the liability) that has now been earned (the revenue).' },
            { id: 23, type: 'Problem', topic: 'Adjustments', q: 'A company recorded insurance paid for 24 months as an expense initially (Expense Method). 3 months have passed. What is the adjusting entry?', options: ['Debit Insurance Expense; Credit Prepaid Insurance.', 'Debit Prepaid Insurance; Credit Cash.', 'Debit Prepaid Insurance; Credit Insurance Expense.', 'Debit Insurance Expense; Credit Cash.'], a: 'Debit Prepaid Insurance; Credit Insurance Expense.', s: 'Since the initial entry was all expense, the adjustment must establish the unexpired portion (21 months) as an asset. Debit Prepaid Insurance (Asset), Credit Insurance Expense (to reduce the expense).' },
            { id: 24, type: 'Problem', topic: 'Adjustments', q: 'The Dec 31 Trial Balance shows Interest Payable of ‚Ç±400. The adjustment for December is for ‚Ç±150. What is the total interest payable after adjustment?', options: ['‚Ç±150', '‚Ç±250', '‚Ç±400', '‚Ç±550'], a: '‚Ç±550', s: 'The existing liability (‚Ç±400) is carried forward, and the new liability (‚Ç±150) is added. ‚Ç±400 + ‚Ç±150 = ‚Ç±550.' },
            { id: 25, type: 'Problem', topic: 'Adjustments', q: 'Equipment was purchased for ‚Ç±10,000. Accumulated Depreciation is ‚Ç±2,000. If the equipment is sold for ‚Ç±8,500, what is the Gain or Loss?', options: ['Gain of ‚Ç±500', 'Loss of ‚Ç±500', 'Gain of ‚Ç±1,500', 'Loss of ‚Ç±1,500'], a: 'Gain of ‚Ç±500', s: 'Book Value = ‚Ç±10,000 - ‚Ç±2,000 = ‚Ç±8,000. Sale Price (‚Ç±8,500) > Book Value (‚Ç±8,000) = Gain of ‚Ç±500.' },
            { id: 26, type: 'Problem', topic: 'Adjustments', q: 'If Prepaid Rent has a ‚Ç±900 adjustment (Debit Rent Expense, Credit Prepaid Rent), what does this mean about the cash flow?', options: ['The cash was paid in a prior period.', 'The cash will be paid in a future period.', 'The cash was paid in this period.', 'Cash is not affected.'], a: 'The cash was paid in a prior period.', s: 'This is a deferral adjustment, meaning the cash transaction occurred *before* the current period\'s expense recognition.' },
            { id: 27, type: 'Problem', topic: 'Adjustments', q: 'On Dec 31, ‚Ç±1,000 of office supplies were purchased on account and correctly recorded. Does this *purchase* require an adjusting entry?', options: ['Yes, Debit Supplies Expense ‚Ç±1,000; Credit Supplies ‚Ç±1,000.', 'Yes, Debit Supplies ‚Ç±1,000; Credit Supplies Expense ‚Ç±1,000.', 'No, but an adjustment is needed for any supplies *used* during the period.', 'No, this transaction is ignored for adjustments.'], a: 'No, but an adjustment is needed for any supplies *used* during the period.', s: 'The purchase itself is a regular transaction. The adjusting entry is only for the amount *used* (consumed) during the period.' },
            { id: 28, type: 'Problem', topic: 'Adjustments', q: 'A company completes a service contract for ‚Ç±5,000. They have been paid half the cash. What is the *transaction* entry?', options: ['Debit Cash ‚Ç±2,500; Credit Service Revenue ‚Ç±2,500.', 'Debit Cash ‚Ç±5,000; Credit Service Revenue ‚Ç±5,000.', 'Debit Cash ‚Ç±2,500; Debit Accounts Receivable ‚Ç±2,500; Credit Service Revenue ‚Ç±5,000.', 'Debit Accounts Receivable ‚Ç±5,000; Credit Service Revenue ‚Ç±5,000.'], a: 'Debit Cash ‚Ç±2,500; Debit Accounts Receivable ‚Ç±2,500; Credit Service Revenue ‚Ç±5,000.', s: 'Revenue is recognized when earned (‚Ç±5,000). The entry records the cash received (‚Ç±2,500) and the amount still to be received (‚Ç±2,500). This is a regular transaction, not an adjustment.' },
            { id: 29, type: 'Problem', topic: 'Adjustments', q: 'Wages of ‚Ç±7,000 have been incurred but not yet paid or recorded. What is the impact of this adjustment on the Balance Sheet?', options: ['Assets will increase by ‚Ç±7,000.', 'Liabilities will increase by ‚Ç±7,000.', 'Equity will increase by ‚Ç±7,000.', 'Assets will decrease by ‚Ç±7,000.'], a: 'Liabilities will increase by ‚Ç±7,000.', s: 'The entry is Debit Wages Expense, Credit Wages Payable. Wages Payable is a Liability account.' },
            { id: 30, type: 'Problem', topic: 'Adjustments', q: 'The adjustment for Unearned Revenue involves a debit to a liability. What is the corresponding credit?', options: ['An Asset account (e.g., Cash).', 'An Expense account.', 'The Owner\'s Capital account.', 'A Revenue account (e.g., Service Revenue).'], a: 'A Revenue account (e.g., Service Revenue).', s: 'The liability is reduced (debited) because the obligation has been fulfilled, and revenue is recognized (credited).' },

            // 10-Column Worksheet (31-60)
            { id: 31, type: 'Theory', topic: 'Worksheet', q: 'The primary purpose of the worksheet is:', options: ['To serve as a formal, published financial statement.', 'To facilitate the preparation of financial statements and check mathematical accuracy.', 'To replace the general journal.', 'To replace the general ledger.'], a: 'To facilitate the preparation of financial statements and check mathematical accuracy.', s: 'It is a voluntary internal tool, not a required formal financial report.' },
            { id: 32, type: 'Theory', topic: 'Worksheet', q: 'Which pair of columns must have equal totals on the worksheet *before* calculating Net Income?', options: ['Trial Balance Debits and Credits.', 'Adjustments Debits and Credits.', 'Adjusted Trial Balance Debits and Credits.', 'Income Statement Debits and Credits.'], a: 'Adjusted Trial Balance Debits and Credits.', s: 'The Adjusted Trial Balance (ATB) is the last set of columns that proves the equality of debits and credits based on the ledger balances.' },
            { id: 33, type: 'Theory', topic: 'Worksheet', q: 'If a company has a Net Loss, how is the worksheet balanced in the Income Statement columns?', options: ['The Net Loss is placed in the Income Statement Debit column.', 'The Net Loss is placed in the Income Statement Credit column.', 'The Net Loss is subtracted from the Debit column.', 'The Net Loss is added to both columns.'], a: 'The Net Loss is placed in the Income Statement Credit column.', s: 'A Net Loss means Expenses (Debit) > Revenue (Credit). The balancing figure (Net Loss) is added to the Credit column to make the totals equal.' },
            { id: 34, type: 'Theory', topic: 'Worksheet', q: 'The Balance Sheet columns of the worksheet include which accounts?', options: ['Assets, Liabilities, and permanent Equity accounts (Capital, Drawings).', 'Revenues and Expenses only.', 'Assets and Liabilities only.', 'Assets, Revenues, and Expenses.'], a: 'Assets, Liabilities, and permanent Equity accounts (Capital, Drawings).', s: 'The Balance Sheet columns contain permanent accounts.' },
            { id: 35, type: 'Theory', topic: 'Worksheet', q: 'Where do the figures for the Adjustments column come from?', options: ['The original trial balance.', 'The unposted adjusting journal entries.', 'The financial statements.', 'The general ledger balances.'], a: 'The unposted adjusting journal entries.', s: 'The adjustments are entered directly into the worksheet columns to see their effect on the ATB and financial statements.' },
            { id: 36, type: 'Theory', topic: 'Worksheet', q: 'In which column set does the Accumulated Depreciation account appear?', options: ['Income Statement columns (as a Debit).', 'Income Statement columns (as a Credit).', 'Balance Sheet columns (as a Debit).', 'Balance Sheet columns (as a Credit).'], a: 'Balance Sheet columns (as a Credit).', s: 'Accumulated Depreciation is a contra-asset, which is a permanent account that appears on the Balance Sheet.' },
            { id: 37, type: 'Theory', topic: 'Worksheet', q: 'A debit entry in the Adjusted Trial Balance for Utilities Expense would be extended to which column of the worksheet?', options: ['Income Statement Debit column.', 'Income Statement Credit column.', 'Balance Sheet Debit column.', 'Balance Sheet Credit column.'], a: 'Income Statement Debit column.', s: 'Expense accounts are temporary accounts and appear on the Income Statement as debits.' },
            { id: 38, type: 'Theory', topic: 'Worksheet', q: 'What is the purpose of the Income Statement columns on the worksheet?', options: ['To prove that assets equal liabilities plus equity.', 'To list all permanent accounts.', 'To compute Net Income or Net Loss.', 'To list all cash transactions.'], a: 'To compute Net Income or Net Loss.', s: 'By summing revenues and expenses, the difference reveals the period\'s profitability.' },
            { id: 39, type: 'Problem', topic: 'Worksheet', q: 'If the ATB Debits are ‚Ç±100,000 and the ATB Credits are ‚Ç±100,000, and the Income Statement Debits are ‚Ç±40,000 and Credits are ‚Ç±70,000, what is the Net Income?', options: ['‚Ç±30,000', '‚Ç±40,000', '‚Ç±70,000', '‚Ç±110,000'], a: '‚Ç±30,000', s: '‚Ç±70,000 (Revenue) - ‚Ç±40,000 (Expense) = ‚Ç±30,000 Net Income.' },
            { id: 40, type: 'Theory', topic: 'Worksheet', q: 'The column that confirms the mathematical equality of the ledger *after* all adjustments is the:', options: ['Trial Balance.', 'Adjustments.', 'Adjusted Trial Balance.', 'Income Statement.'], a: 'Adjusted Trial Balance.', s: 'The ATB columns are the final check of ledger integrity before splitting the amounts into IS and BS columns.' },
            { id: 41, type: 'Problem', topic: 'Worksheet', q: 'ATB: Rent Expense ‚Ç±3,000. Its value in the Balance Sheet Debit column is:', options: ['‚Ç±3,000', '‚Ç±0', '‚Ç±6,000', '(‚Ç±3,000)'], a: '‚Ç±0', s: 'Rent Expense is an Income Statement account, so it should not be extended to the Balance Sheet columns.' },
            { id: 42, type: 'Problem', topic: 'Worksheet', q: 'ATB: Accounts Payable ‚Ç±5,000 Credit. This amount is extended to which column and side?', options: ['Income Statement Credit.', 'Income Statement Debit.', 'Balance Sheet Credit.', 'Balance Sheet Debit.'], a: 'Balance Sheet Credit.', s: 'Accounts Payable is a Liability, a permanent account on the Balance Sheet, and has a normal Credit balance.' },
            { id: 43, type: 'Problem', topic: 'Worksheet', q: 'If the Income Statement Debits are ‚Ç±80,000 and the Credits are ‚Ç±65,000, the balancing figure is a:', options: ['Net Income of ‚Ç±15,000.', 'Net Loss of ‚Ç±15,000.', 'Net Income of ‚Ç±145,000.', 'Net Loss of ‚Ç±145,000.'], a: 'Net Loss of ‚Ç±15,000.', s: 'Expenses (‚Ç±80,000 Debits) > Revenues (‚Ç±65,000 Credits) = Net Loss of ‚Ç±15,000.' },
            { id: 44, type: 'Problem', topic: 'Worksheet', q: 'Where is the Net Income figure entered in the Balance Sheet columns of the worksheet?', options: ['Balance Sheet Debit column.', 'Balance Sheet Credit column.', 'Both Debit and Credit columns.', 'It is not entered in the Balance Sheet columns.'], a: 'Balance Sheet Credit column.', s: 'Net Income increases equity, and equity is a credit-balance account, so Net Income is added to the Balance Sheet Credit column to balance it.' },
            { id: 45, type: 'Problem', topic: 'Worksheet', q: 'Trial Balance shows Unearned Revenue ‚Ç±1,000. Adjustment is Debit ‚Ç±400. What is the Adjusted Trial Balance balance?', options: ['‚Ç±400 Credit', '‚Ç±600 Credit', '‚Ç±1,000 Credit', '‚Ç±1,400 Credit'], a: '‚Ç±600 Credit', s: '‚Ç±1,000 Credit - ‚Ç±400 Debit = ‚Ç±600 Credit.' },
            { id: 46, type: 'Problem', topic: 'Worksheet', q: 'ATB: Capital ‚Ç±50,000 Credit, Drawings ‚Ç±5,000 Debit. Where are these extended?', options: ['Both to Balance Sheet Credit.', 'Both to Balance Sheet Debit.', 'Capital to Balance Sheet Credit; Drawings to Balance Sheet Debit.', 'Capital to Income Statement Credit; Drawings to Income Statement Debit.'], a: 'Capital to Balance Sheet Credit; Drawings to Balance Sheet Debit.', s: 'Both are equity-related (permanent) accounts, extended to the Balance Sheet columns according to their normal balances.' },
            { id: 47, type: 'Problem', topic: 'Worksheet', q: 'The total of the Income Statement Credit column is ‚Ç±90,000, and the Income Statement Debit column is ‚Ç±55,000. What figure balances the Income Statement?', options: ['‚Ç±35,000 added to the Debit column.', '‚Ç±35,000 added to the Credit column.', '‚Ç±145,000 added to the Debit column.', '‚Ç±145,000 added to the Credit column.'], a: '‚Ç±35,000 added to the Debit column.', s: '‚Ç±90,000 - ‚Ç±55,000 = ‚Ç±35,000 Net Income. It is added to the debit side to make Debits equal Credits.' },
            { id: 48, type: 'Problem', topic: 'Worksheet', q: 'If the Balance Sheet Debits total ‚Ç±120,000 and the Credits total ‚Ç±85,000 (before balancing), how is the Balance Sheet balanced?', options: ['‚Ç±35,000 added to the Debit column.', '‚Ç±35,000 added to the Credit column.', '‚Ç±205,000 added to the Credit column.', 'The sheet is already balanced.'], a: '‚Ç±35,000 added to the Credit column.', s: 'Assets (Debit) must equal Liabilities + Equity (Credit). The difference is the Net Income (‚Ç±35,000), which is added to the Credit side.' },
            { id: 49, type: 'Problem', topic: 'Worksheet', q: 'A new account, Depreciation Expense, is introduced in the Adjustments columns. In the Adjusted Trial Balance, this account will have a:', options: ['Debit balance equal to the adjustment amount.', 'Credit balance equal to the adjustment amount.', 'Zero balance.', 'A balance equal to the related asset.'], a: 'Debit balance equal to the adjustment amount.', s: 'Since there was no prior balance, the adjustment debit becomes the ATB debit.' },
            { id: 50, type: 'Problem', topic: 'Worksheet', q: 'The total of the Balance Sheet Debits (before balancing) represents the total of:', options: ['Assets only.', 'Assets and Expenses.', 'Assets and Drawings.', 'Assets and Liabilities.'], a: 'Assets and Drawings.', s: 'The normal balance for both Assets and Drawings is Debit, and they are extended to the BS Debit column.' },
            { id: 51, type: 'Problem', topic: 'Worksheet', q: 'Trial Balance Debits total ‚Ç±200,000. Adjustments Debits total ‚Ç±15,000, Adjustments Credits total ‚Ç±15,000. What is the Adjusted Trial Balance Debit total?', options: ['‚Ç±200,000', '‚Ç±215,000', '‚Ç±185,000', 'Cannot be determined without knowing how the individual accounts adjusted.'], a: 'Cannot be determined without knowing how the individual accounts adjusted.', s: 'The ATB total is NOT simply the sum of TB and Adjustments totals. An adjustment debit might be to an account that had a credit balance, or vice-versa.' },
            { id: 52, type: 'Problem', topic: 'Worksheet', q: 'ATB: Service Revenue ‚Ç±40,000. It is extended to the Income Statement Credit column. What is its value in the Balance Sheet Credit column?', options: ['‚Ç±40,000', '‚Ç±0', '(‚Ç±40,000)', '‚Ç±20,000'], a: '‚Ç±0', s: 'Revenues are temporary accounts and do not appear in the Balance Sheet columns.' },
            { id: 53, type: 'Problem', topic: 'Worksheet', q: 'If the net change for the period is a Net Loss of ‚Ç±12,000, where is this figure placed in the Balance Sheet columns?', options: ['Balance Sheet Debit column.', 'Balance Sheet Credit column.', 'Income Statement Debit column.', 'It is not placed in the BS columns.'], a: 'Balance Sheet Debit column.', s: 'Net Loss decreases Equity. Since Equity has a normal Credit balance, a decrease in Equity is recorded as a Debit.' },
            { id: 54, type: 'Problem', topic: 'Worksheet', q: 'A company reports a Net Income of ‚Ç±10,000. What entry balances the Balance Sheet columns?', options: ['A ‚Ç±10,000 entry in the Debit column.', 'A ‚Ç±10,000 entry in the Credit column.', 'A ‚Ç±20,000 entry in the Debit column.', 'A ‚Ç±20,000 entry in the Credit column.'], a: 'A ‚Ç±10,000 entry in the Credit column.', s: 'Net Income increases equity, which is recorded as a credit on the Balance Sheet.' },
            { id: 55, type: 'Problem', topic: 'Worksheet', q: 'If Rent Payable has a ‚Ç±500 Credit adjustment, what is its extension on the worksheet?', options: ['Income Statement Credit ‚Ç±500.', 'Income Statement Debit ‚Ç±500.', 'Balance Sheet Credit ‚Ç±500.', 'Balance Sheet Debit ‚Ç±500.'], a: 'Balance Sheet Credit ‚Ç±500.', s: 'Rent Payable is a Liability, a permanent account.' },
            { id: 56, type: 'Theory', topic: 'Worksheet', q: 'Which account type is NOT extended to the Income Statement columns?', options: ['Revenue accounts.', 'Expense accounts.', 'Asset accounts.', 'Contra-Revenue accounts.'], a: 'Asset accounts.', s: 'Assets, Liabilities, and permanent Equity accounts are extended to the Balance Sheet columns.' },
            { id: 57, type: 'Problem', topic: 'Worksheet', q: 'If the Adjusted Trial Balance balance for Accumulated Depreciation is ‚Ç±12,000, its extension is:', options: ['Balance Sheet Debit ‚Ç±12,000.', 'Balance Sheet Credit ‚Ç±12,000.', 'Income Statement Debit ‚Ç±12,000.', 'Income Statement Credit ‚Ç±12,000.'], a: 'Balance Sheet Credit ‚Ç±12,000.', s: 'Contra-assets have a normal credit balance and are permanent accounts.' },
            { id: 58, type: 'Problem', topic: 'Worksheet', q: 'The total of the Income Statement Debit column before balancing is ‚Ç±55,000. This represents the total of all:', options: ['Revenues for the period.', 'Expenses for the period.', 'Assets for the period.', 'Liabilities for the period.'], a: 'Expenses for the period.', s: 'Expenses have a normal debit balance and are the only debit accounts extended to the IS columns.' },
            { id: 59, type: 'Problem', topic: 'Worksheet', q: 'A Net Income of ‚Ç±25,000 appears in which two columns for balancing?', options: ['Income Statement Debit and Balance Sheet Credit.', 'Income Statement Credit and Balance Sheet Debit.', 'Income Statement Debit and Balance Sheet Debit.', 'Income Statement Credit and Balance Sheet Credit.'], a: 'Income Statement Debit and Balance Sheet Credit.', s: 'It balances the IS (added to the smaller Debit side) and increases Equity (added to the smaller Credit side, as Assets > L+E before NI).' },
            { id: 60, type: 'Problem', topic: 'Worksheet', q: 'Trial Balance: Cash ‚Ç±10,000. Adjustment: None. Adjusted Trial Balance Balance Sheet extension is:', options: ['Debit ‚Ç±10,000.', 'Credit ‚Ç±10,000.', 'Debit ‚Ç±0.', 'Credit ‚Ç±0.'], a: 'Debit ‚Ç±10,000.', s: 'Cash is an asset, its balance is unchanged, and it is a Balance Sheet (permanent) account.' },

            // Financial Statements & Mixed (61-100)
            { id: 61, type: 'Theory', topic: 'Statements', q: 'The Income Statement is prepared for a *period of time*. What is the starting point for this statement?', options: ['Assets.', 'Expenses.', 'Revenues.', 'Equity.'], a: 'Revenues.', s: 'The Income Statement starts by listing all revenues.' },
            { id: 62, type: 'Theory', topic: 'Statements', q: 'Net Income is an essential figure that links which two financial statements?', options: ['Income Statement and Balance Sheet.', 'Balance Sheet and Statement of Cash Flows.', 'Income Statement and Statement of Changes in Equity (or Retained Earnings).', 'Balance Sheet and Trial Balance.'], a: 'Income Statement and Statement of Changes in Equity (or Retained Earnings).', s: 'Net Income is the final result of the Income Statement and the starting input for the Equity statement.' },
            { id: 63, type: 'Theory', topic: 'Statements', q: 'Which of the following accounts is *not* found on the Balance Sheet?', options: ['Cash.', 'Accounts Payable.', 'Interest Expense.', 'Accumulated Depreciation.'], a: 'Interest Expense.', s: 'Interest Expense is a temporary account found on the Income Statement.' },
            { id: 64, type: 'Theory', topic: 'Statements', q: 'The Statement of Changes in Equity reports changes in equity for which type of entity?', options: ['Corporations only.', 'Proprietorships and Partnerships.', 'Non-profit organizations.', 'Government agencies.'], a: 'Proprietorships and Partnerships.', s: 'For corporations, the Statement of Retained Earnings (a component of equity) is more common.' },
            { id: 65, type: 'Theory', topic: 'Statements', q: 'What is the order of preparation for the three main financial statements?', options: ['Balance Sheet, Income Statement, Statement of Changes in Equity.', 'Income Statement, Statement of Changes in Equity, Balance Sheet.', 'Statement of Changes in Equity, Balance Sheet, Income Statement.', 'Balance Sheet, Statement of Changes in Equity, Income Statement.'], a: 'Income Statement, Statement of Changes in Equity, Balance Sheet.', s: 'The output of each statement is needed for the next: Net Income -> Equity Statement -> Ending Equity -> Balance Sheet.' },
            { id: 66, type: 'Theory', topic: 'Statements', q: 'A debit balance in the Drawings account on the Adjusted Trial Balance is used to prepare:', options: ['The Income Statement.', 'The Balance Sheet.', 'The Statement of Changes in Equity.', 'The Post-Closing Trial Balance.'], a: 'The Statement of Changes in Equity.', s: 'Drawings reduce equity and are a key component in calculating the ending capital on the SCE.' },
            { id: 67, type: 'Theory', topic: 'Statements', q: 'In the Statement of Changes in Equity for a proprietorship, what *increases* the ending capital balance?', options: ['Net Loss and Owner Investments.', 'Net Income and Owner Drawings.', 'Net Loss and Owner Drawings.', 'Net Income and Owner Investments.'], a: 'Net Income and Owner Investments.', s: 'These are additions. Net Loss and Owner Drawings reduce the balance.' },
            { id: 68, type: 'Theory', topic: 'Statements', q: 'Which section of the worksheet provides the data for the Assets and Liabilities on the Balance Sheet?', options: ['Income Statement columns.', 'Adjustments columns.', 'Trial Balance columns.', 'Balance Sheet columns.'], a: 'Balance Sheet columns.', s: 'This section contains all the permanent accounts needed for the Balance Sheet.' },
            { id: 69, type: 'Theory', topic: 'Statements', q: 'Which principle governs the presentation of revenues and expenses on the Income Statement?', options: ['Cash basis accounting.', 'Accrual basis accounting.', 'The cost principle.', 'The conservatism principle.'], a: 'Accrual basis accounting.', s: 'The entire adjusting process ensures the Income Statement follows the accrual basis by matching revenues and expenses.' },
            { id: 70, type: 'Theory', topic: 'Statements', q: 'The formula: Beginning Capital + Net Income - Drawings = Ending Capital is used in which financial statement?', options: ['Income Statement.', 'Balance Sheet.', 'Statement of Changes in Equity.', 'Statement of Cash Flows.'], a: 'Statement of Changes in Equity.', s: 'This is the basic formula for a proprietorship\'s equity statement.' },
            { id: 71, type: 'Problem', topic: 'Statements', q: 'If total Assets are ‚Ç±150,000 and total Liabilities are ‚Ç±60,000, what is the total Owner\'s Equity?', options: ['‚Ç±90,000', '‚Ç±210,000', '‚Ç±150,000', '‚Ç±60,000'], a: '‚Ç±90,000', s: 'Accounting Equation: Assets = Liabilities + Equity. ‚Ç±150,000 - ‚Ç±60,000 = ‚Ç±90,000.' },
            { id: 72, type: 'Theory', topic: 'Statements', q: 'Which statement provides information about the business at a **specific point in time**?', options: ['Income Statement.', 'Statement of Changes in Equity.', 'Balance Sheet (Statement of Financial Position).', 'Statement of Cash Flows.'], a: 'Balance Sheet (Statement of Financial Position).', s: 'Unlike the other two, the Balance Sheet is a snapshot of financial position on a particular date.' },
            { id: 73, type: 'Theory', topic: 'Statements', q: 'In the Statement of Changes in Equity, which item is *not* an expense but reduces the owner\'s capital?', options: ['Rent Expense.', 'Salaries Expense.', 'Drawings (or Dividends for a corporation).', 'Depreciation Expense.'], a: 'Drawings (or Dividends for a corporation).', s: 'Drawings are distributions of capital, not business expenses.' },
            { id: 74, type: 'Theory', topic: 'Statements', q: 'What does the term "retained earnings" refer to in a corporation?', options: ['The amount of cash the company has.', 'The cumulative net income earned by the company less the cumulative dividends declared since inception.', 'The total amount of revenue earned in the period.', 'The total value of the company\'s assets.'], a: 'The cumulative net income earned by the company less the cumulative dividends declared since inception.', s: 'Retained Earnings represents the portion of profit kept (retained) in the business.' },
            { id: 75, type: 'Theory', topic: 'Statements', q: 'The net effect of closing entries is to transfer the balances of all temporary accounts to:', options: ['The Cash account.', 'The Asset accounts.', 'The Capital/Retained Earnings account.', 'The Liability accounts.'], a: 'The Capital/Retained Earnings account.', s: 'Closing entries zero out temporary accounts (Revenues, Expenses, Dividends/Drawings) and update the permanent equity account.' },
            { id: 76, type: 'Theory', topic: 'Statements', q: 'An unadjusted revenue account balance is correct, but an accrued expense adjustment is forgotten. What is the impact on the Balance Sheet?', options: ['Assets are overstated and Equity is overstated.', 'Liabilities are understated and Equity is overstated.', 'Liabilities are overstated and Equity is understated.', 'Assets are understated and Liabilities are understated.'], a: 'Liabilities are understated and Equity is overstated.', s: 'The liability (Payable) is missing, and because Net Income is overstated (due to missing expense), Equity is also overstated.' },
            { id: 77, type: 'Theory', topic: 'Statements', q: 'A contra-asset account is shown as a reduction of its related asset on which statement?', options: ['Income Statement.', 'Balance Sheet.', 'Statement of Changes in Equity.', 'It is not shown, only the net amount.'], a: 'Balance Sheet.', s: 'For example, Accumulated Depreciation reduces Equipment to show the Book Value.' },
            { id: 78, type: 'Theory', topic: 'Statements', q: 'The Philippine framework generally mandates the Balance Sheet be classified into Current and Non-current items. This type of presentation is based on:', options: ['Profitability.', 'Historical cost.', 'Liquidity/Solvency assessment.', 'Owner\'s preference.'], a: 'Liquidity/Solvency assessment.', s: 'Classification helps users assess the company\'s ability to meet short-term obligations (liquidity).' },
            { id: 79, type: 'Problem', topic: 'Statements', q: 'If Rent Revenue has an Adjusted Trial Balance balance of ‚Ç±5,000 and Salaries Expense is ‚Ç±2,000, the Income Statement Credit column total is *at least*:', options: ['‚Ç±2,000', '‚Ç±3,000', '‚Ç±5,000', '‚Ç±7,000'], a: '‚Ç±5,000', s: 'The Income Statement Credit column includes all Revenue accounts (Credits). The total is at least the sum of all revenue accounts.' },
            { id: 80, type: 'Theory', topic: 'Statements', q: 'When preparing the Balance Sheet, which specific amount is sourced directly from the Statement of Changes in Equity?', options: ['The Ending Capital balance.', 'Total Assets.', 'Net Income.', 'Total Liabilities.'], a: 'The Ending Capital balance.', s: 'The SCE calculates the final capital amount, which is then shown in the Equity section of the Balance Sheet.' },
            { id: 81, type: 'Problem', topic: 'Statements', q: 'Service Revenue ‚Ç±100,000, Salaries Expense ‚Ç±30,000, Rent Expense ‚Ç±10,000. Calculate Net Income.', options: ['‚Ç±60,000', '‚Ç±70,000', '‚Ç±100,000', '‚Ç±140,000'], a: '‚Ç±60,000', s: 'Net Income = ‚Ç±100,000 - ‚Ç±30,000 - ‚Ç±10,000 = ‚Ç±60,000.' },
            { id: 82, type: 'Problem', topic: 'Statements', q: 'Beginning Capital ‚Ç±50,000. Net Income ‚Ç±10,000. Drawings ‚Ç±4,000. Calculate Ending Capital.', options: ['‚Ç±50,000', '‚Ç±56,000', '‚Ç±60,000', '‚Ç±64,000'], a: '‚Ç±56,000', s: '‚Ç±50,000 + ‚Ç±10,000 - ‚Ç±4,000 = ‚Ç±56,000.' },
            { id: 83, type: 'Problem', topic: 'Statements', q: 'Total Assets ‚Ç±200,000. Total Liabilities ‚Ç±50,000. Total Equity must be:', options: ['‚Ç±50,000', '‚Ç±150,000', '‚Ç±200,000', '‚Ç±250,000'], a: '‚Ç±150,000', s: 'Accounting Equation: Assets = Liabilities + Equity. ‚Ç±200,000 - ‚Ç±50,000 = ‚Ç±150,000.' },
            { id: 84, type: 'Problem', topic: 'Statements', q: 'If Unadjusted Trial Balance Debits total ‚Ç±150,000, and the only adjustment is a Debit to Supplies Expense for ‚Ç±10,000 and a Credit to Supplies for ‚Ç±10,000, what is the Adjusted Trial Balance Debit total?', options: ['‚Ç±140,000', '‚Ç±150,000', '‚Ç±160,000', '‚Ç±10,000'], a: '‚Ç±150,000', s: 'Since the adjustment debit equals the adjustment credit (‚Ç±10,000), the total debit/credit totals remain the same.' },
            { id: 85, type: 'Problem', topic: 'Statements', q: 'ATB: Rent Revenue ‚Ç±20,000, Depreciation Expense ‚Ç±1,000. What are the Income Statement Debits and Credits?', options: ['IS Debits ‚Ç±1,000; IS Credits ‚Ç±20,000.', 'IS Debits ‚Ç±20,000; IS Credits ‚Ç±1,000.', 'IS Debits ‚Ç±21,000; IS Credits ‚Ç±0.', 'IS Debits ‚Ç±0; IS Credits ‚Ç±21,000.'], a: 'IS Debits ‚Ç±1,000; IS Credits ‚Ç±20,000.', s: 'Revenue is a credit, Expense is a debit.' },
            { id: 86, type: 'Problem', topic: 'Statements', q: 'Beginning Retained Earnings ‚Ç±30,000. Net Loss ‚Ç±5,000. Dividends Declared ‚Ç±2,000. Calculate Ending Retained Earnings.', options: ['‚Ç±23,000', '‚Ç±27,000', '‚Ç±33,000', '‚Ç±37,000'], a: '‚Ç±23,000', s: '‚Ç±30,000 - ‚Ç±5,000 (Loss) - ‚Ç±2,000 (Dividends) = ‚Ç±23,000.' },
            { id: 87, type: 'Problem', topic: 'Statements', q: 'Total Revenues are ‚Ç±80,000, and total Expenses are ‚Ç±65,000. The Income Statement columns of the worksheet balance with:', options: ['‚Ç±15,000 Net Income, entered as an IS Debit.', '‚Ç±15,000 Net Income, entered as an IS Credit.', '‚Ç±15,000 Net Loss, entered as an IS Debit.', '‚Ç±15,000 Net Loss, entered as an IS Credit.'], a: '‚Ç±15,000 Net Income, entered as an IS Debit.', s: 'Net Income is Revenue minus Expense. It is added to the debit side to balance the IS columns.' },
            { id: 88, type: 'Problem', topic: 'Statements', q: 'Equipment ‚Ç±50,000, Accumulated Depreciation ‚Ç±10,000, Cash ‚Ç±5,000. What is the total of Current Assets?', options: ['‚Ç±5,000', '‚Ç±40,000', '‚Ç±45,000', '‚Ç±55,000'], a: '‚Ç±5,000', s: 'Cash is the only current asset listed. Equipment (net of Acc. Dep.) is a non-current (long-term) asset.' },
            { id: 89, type: 'Problem', topic: 'Statements', q: 'If ending Owner\'s Capital is ‚Ç±90,000, Beginning Capital was ‚Ç±70,000, and Drawings were ‚Ç±5,000, calculate the Net Income (assuming no new investments).', options: ['‚Ç±15,000', '‚Ç±20,000', '‚Ç±25,000', '‚Ç±30,000'], a: '‚Ç±25,000', s: 'Ending Cap. (‚Ç±90,000) = Beg. Cap. (‚Ç±70,000) + NI - Drawings (‚Ç±5,000). NI = ‚Ç±90,000 - ‚Ç±70,000 + ‚Ç±5,000 = ‚Ç±25,000.' },
            { id: 90, type: 'Problem', topic: 'Statements', q: 'The Adjusted Trial Balance balance for Prepaid Rent is ‚Ç±1,200. This represents 6 months of rent. What was the *monthly* rent expense?', options: ['‚Ç±1,200', '‚Ç±200', '‚Ç±7,200', 'Cannot be determined.'], a: '‚Ç±200', s: 'If the remaining asset is ‚Ç±1,200 for 6 months, the monthly rate is ‚Ç±1,200 / 6 = ‚Ç±200.' },
            { id: 91, type: 'Problem', topic: 'Statements', q: 'An accrued expense adjustment of ‚Ç±400 (Debit Expense, Credit Payable) is missed. What is the effect on the Balance Sheet?', options: ['Liabilities are understated by ‚Ç±400.', 'Assets are understated by ‚Ç±400.', 'Liabilities are overstated by ‚Ç±400.', 'Equity is understated by ‚Ç±400.'], a: 'Liabilities are understated by ‚Ç±400.', s: 'The liability (Payable account) is missing, causing Liabilities to be understated.' },
            { id: 92, type: 'Theory', topic: 'Statements', q: 'Which pair of accounts would *not* appear in the same section (Income Statement or Balance Sheet) of the worksheet?', options: ['Cash and Accounts Payable.', 'Salaries Expense and Rent Expense.', 'Unearned Revenue and Service Revenue.', 'Owner\'s Capital and Owner\'s Drawings.'], a: 'Unearned Revenue and Service Revenue.', s: 'Unearned Revenue is Balance Sheet (Liability); Service Revenue is Income Statement (Revenue).' },
            { id: 93, type: 'Problem', topic: 'Statements', q: 'What is the amount of total expenses if Rent Expense is ‚Ç±5,000, Salaries Expense is ‚Ç±15,000, and Depreciation Expense is ‚Ç±2,000?', options: ['‚Ç±20,000', '‚Ç±22,000', '‚Ç±18,000', '‚Ç±15,000'], a: '‚Ç±22,000', s: 'Total Expenses = ‚Ç±5,000 + ‚Ç±15,000 + ‚Ç±2,000 = ‚Ç±22,000.' },
            { id: 94, type: 'Problem', topic: 'Statements', q: 'If the total of the Balance Sheet Debits (before balancing) is ‚Ç±250,000 and the Net Income is ‚Ç±30,000, what must the total of the Balance Sheet Credits be (before balancing)?', options: ['‚Ç±220,000', '‚Ç±250,000', '‚Ç±280,000', '‚Ç±30,000'], a: '‚Ç±220,000', s: 'Total BS Debits (‚Ç±250,000) = Total BS Credits (x) + Net Income (‚Ç±30,000). x = ‚Ç±250,000 - ‚Ç±30,000 = ‚Ç±220,000.' },
            { id: 95, type: 'Theory', topic: 'Statements', q: 'A company reports a Net Loss of ‚Ç±12,000. How does this affect the calculation of ending Owner\'s Capital?', options: ['It increases the capital balance.', 'It reduces the capital balance.', 'It has no effect on capital.', 'It increases liabilities.'], a: 'It reduces the capital balance.', s: 'Net Loss is subtracted from the beginning capital balance.' },
            { id: 96, type: 'Problem', topic: 'Statements', q: 'A full Balance Sheet reports Equipment at Cost of ‚Ç±70,000. Accumulated Depreciation is ‚Ç±15,000. How is this presented?', options: ['Non-current Asset, Equipment ‚Ç±70,000.', 'Non-current Asset, Equipment ‚Ç±55,000.', 'Non-current Asset, Equipment ‚Ç±70,000 less Accumulated Depreciation ‚Ç±15,000 (Book Value ‚Ç±55,000).', 'Non-current Asset, Equipment ‚Ç±15,000.'], a: 'Non-current Asset, Equipment ‚Ç±70,000 less Accumulated Depreciation ‚Ç±15,000 (Book Value ‚Ç±55,000).', s: 'Assets are reported at their book value, which is cost minus accumulated depreciation.' },
            { id: 97, type: 'Problem', topic: 'Statements', q: 'If Unearned Revenue (liability) has an ATB balance of ‚Ç±500, and Cash (asset) has a balance of ‚Ç±5,000, what is the total of the Balance Sheet Debits from just these accounts?', options: ['‚Ç±4,500', '‚Ç±5,000', '‚Ç±5,500', '‚Ç±500'], a: '‚Ç±5,000', s: 'Only the Asset (Cash) has a Debit balance. The Liability (Unearned Revenue) has a Credit balance.' },
            { id: 98, type: 'Problem', topic: 'Statements', q: 'A company recorded salaries paid as ‚Ç±15,000. Accrued salaries are ‚Ç±2,000. What is the total Salaries Expense on the Income Statement?', options: ['‚Ç±2,000', '‚Ç±13,000', '‚Ç±15,000', '‚Ç±17,000'], a: '‚Ç±17,000', s: 'Total Expense = Paid Expense (‚Ç±15,000) + Accrued Expense (‚Ç±2,000) = ‚Ç±17,000.' },
            { id: 99, type: 'Theory', topic: 'Statements', q: 'The formula: Revenue - Cost of Goods Sold = Gross Profit is the starting point for which format of the Income Statement?', options: ['Single-Step Income Statement (used by service firms).', 'Multi-Step Income Statement (used by merchandising firms).', 'Statement of Changes in Equity.', 'Balance Sheet.'], a: 'Multi-Step Income Statement (used by merchandising firms).', s: 'A service firm typically uses a Single-Step Income Statement (Total Revenues - Total Expenses).' },
            { id: 100, type: 'Problem', topic: 'Statements', q: 'A Trial Balance shows Rent Expense ‚Ç±1,000. The adjustment is Debit Rent Expense ‚Ç±500, Credit Rent Payable ‚Ç±500. What is the Rent Expense in the Income Statement columns?', options: ['‚Ç±500', '‚Ç±1,000', '‚Ç±1,500', '‚Ç±2,000'], a: '‚Ç±1,500', s: 'ATB Rent Expense = TB Rent Exp. (‚Ç±1,000) + Adjustment Debit (‚Ç±500) = ‚Ç±1,500.' },

            // --- NEW 100 Questions (Steps 7-10) ---
            // Adjusting Entries (Journalizing/Posting) - 5 Questions
            { id: 101, type: 'Theory', topic: 'Step 7', q: 'What is the primary purpose of Step 7: Journalizing Adjusting Entries?', options: ['To prepare the worksheet.', 'To formally record the adjustments from the worksheet into the general journal.', 'To close the temporary accounts.', 'To prepare the post-closing trial balance.'], a: 'To formally record the adjustments from the worksheet into the general journal.', s: 'The worksheet is an internal tool; this step makes the adjustments part of the permanent accounting record.' },
            { id: 102, type: 'Theory', topic: 'Step 7', q: 'After journalizing adjusting entries, what is the immediate next step?', options: ['Posting the adjusting entries to the general ledger.', 'Preparing the income statement.', 'Preparing the closing entries.', 'Preparing the reversing entries.'], a: 'Posting the adjusting entries to the general ledger.', s: 'Journalizing (Step 7a) is followed by Posting (Step 7b) to update the ledger account balances.' },
            { id: 103, type: 'Problem', topic: 'Step 7', q: 'The worksheet adjustment for insurance shows a ‚Ç±500 debit to Insurance Expense and ‚Ç±500 credit to Prepaid Insurance. What is the journal entry?', options: ['Debit Prepaid Insurance ‚Ç±500; Credit Insurance Expense ‚Ç±500.', 'Debit Insurance Expense ‚Ç±500; Credit Prepaid Insurance ‚Ç±500.', 'Debit Insurance Expense ‚Ç±500; Credit Cash ‚Ç±500.', 'Debit Prepaid Insurance ‚Ç±500; Credit Cash ‚Ç±500.'], a: 'Debit Insurance Expense ‚Ç±500; Credit Prepaid Insurance ‚Ç±500.', s: 'The journal entry is a direct copy of the adjustment columns from the worksheet.' },
            { id: 104, type: 'Theory', topic: 'Step 7', q: 'If adjusting entries are journalized but *not* posted, what will be incorrect?', options: ['The general journal.', 'The worksheet.', 'The general ledger balances and the financial statements.', 'The bank statement.'], a: 'The general ledger balances and the financial statements.', s: 'Posting is required to update the ledger, which is the source for the financial statements.' },
            { id: 105, type: 'Problem', topic: 'Step 7', q: 'The worksheet shows an adjustment for accrued salaries: ‚Ç±1,200 debit to Salaries Expense, ‚Ç±1,200 credit to Salaries Payable. Write the journal entry.', options: ['Debit Salaries Payable ‚Ç±1,200; Credit Salaries Expense ‚Ç±1,200.', 'Debit Salaries Expense ‚Ç±1,200; Credit Cash ‚Ç±1,200.', 'Debit Salaries Expense ‚Ç±1,200; Credit Salaries Payable ‚Ç±1,200.', 'Debit Cash ‚Ç±1,200; Credit Salaries Payable ‚Ç±1,200.'], a: 'Debit Salaries Expense ‚Ç±1,200; Credit Salaries Payable ‚Ç±1,200.', s: 'This formally records the accrued expense in the journal.' },

            // Closing Entries (Theory) - 20 Questions
            { id: 106, type: 'Theory', topic: 'Step 8', q: 'What is the primary purpose of closing entries?', options: ['To prepare the adjusting entries.', 'To record daily transactions.', 'To zero out all temporary accounts and transfer net income/loss to the capital account.', 'To correct errors made during the period.'], a: 'To zero out all temporary accounts and transfer net income/loss to the capital account.', s: 'This resets the nominal accounts (revenues, expenses, drawings) for the next period.' },
            { id: 107, type: 'Theory', topic: 'Step 8', q: 'Which of the following accounts is a "temporary" or "nominal" account?', options: ['Cash.', 'Rent Expense.', 'Accounts Payable.', 'Owner\'s Capital.'], a: 'Rent Expense.', s: 'Expenses, Revenues, and Drawings are temporary. Assets, Liabilities, and Capital are permanent.' },
            { id: 108, type: 'Theory', topic: 'Step 8', q: 'Which of the following accounts is a "permanent" or "real" account?', options: ['Service Revenue.', 'Accumulated Depreciation.', 'Salaries Expense.', 'Owner\'s Drawings.'], a: 'Accumulated Depreciation.', s: 'Accumulated Depreciation is a contra-asset, which is a permanent balance sheet account.' },
            { id: 109, type: 'Theory', topic: 'Step 8', q: 'The temporary account used to facilitate the closing process is called:', options: ['Income Summary.', 'Owner\'s Capital.', 'Net Income.', 'Retained Earnings.'], a: 'Income Summary.', s: 'Revenues and expenses are closed to Income Summary first.' },
            { id: 110, type: 'Theory', topic: 'Step 8', q: 'What is the first step in the four-step closing process?', options: ['Close all Expense accounts to Income Summary.', 'Close all Revenue accounts to Income Summary.', 'Close Income Summary to Owner\'s Capital.', 'Close Owner\'s Drawings to Owner\'s Capital.'], a: 'Close all Revenue accounts to Income Summary.', s: 'The acronym is REID: Revenues, Expenses, Income Summary, Drawings.' },
            { id: 111, type: 'Theory', topic: 'Step 8', q: 'What is the second step in the four-step closing process?', options: ['Close all Expense accounts to Income Summary.', 'Close all Revenue accounts to Income Summary.', 'Close Income Summary to Owner\'s Capital.', 'Close Owner\'s Drawings to Owner\'s Capital.'], a: 'Close all Expense accounts to Income Summary.', s: 'REID: Revenues, Expenses, Income Summary, Drawings.' },
            { id: 112, type: 'Theory', topic: 'Step 8', q: 'What is the third step in the four-step closing process?', options: ['Close all Expense accounts to Income Summary.', 'Close all Revenue accounts to Income Summary.', 'Close the Income Summary account to Owner\'s Capital.', 'Close the Drawings account to Owner\'s Capital.'], a: 'Close the Income Summary account to Owner\'s Capital.', s: 'REID: Revenues, Expenses, Income Summary, Drawings. This step transfers the net income or loss.' },
            { id: 113, type: 'Theory', topic: 'Step 8', q: 'What is the fourth step in the four-step closing process?', options: ['Close all Expense accounts to Income Summary.', 'Close all Revenue accounts to Income Summary.', 'Close Income Summary to Owner\'s Capital.', 'Close the Drawings account to Owner\'s Capital.'], a: 'Close the Drawings account to Owner\'s Capital.', s: 'REID: Revenues, Expenses, Income Summary, Drawings. This step reduces capital by the owner\'s withdrawals.' },
            { id: 114, type: 'Theory', topic: 'Step 8', q: 'After closing entries are posted, what will be the balance of the Service Revenue account?', options: ['Its ending balance.', 'Its beginning balance.', 'Zero.', 'A negative balance.'], a: 'Zero.', s: 'All temporary accounts (revenues, expenses, drawings) are reset to zero.' },
            { id: 115, type: 'Theory', topic: 'Step 8', q: 'After closing entries are posted, what will be the balance of the Salaries Expense account?', options: ['Its ending balance.', 'Its beginning balance.', 'Zero.', 'A positive balance.'], a: 'Zero.', s: 'All temporary accounts (revenues, expenses, drawings) are reset to zero.' },
            { id: 116, type: 'Theory', topic: 'Step 8', q: 'After closing entries are posted, what will be the balance of the Drawings account?', options: ['Its ending balance.', 'Its beginning balance.', 'Zero.', 'A credit balance.'], a: 'Zero.', s: 'All temporary accounts (revenues, expenses, drawings) are reset to zero.' },
            { id: 117, type: 'Theory', topic: 'Step 8', q: 'After closing entries are posted, what will be the balance of the Cash account?', options: ['Its ending balance (it is not closed).', 'Zero.', 'Its beginning balance.', 'A credit balance.'], a: 'Its ending balance (it is not closed).', s: 'Cash is a permanent (asset) account and is not affected by closing entries.' },
            { id: 118, type: 'Theory', topic: 'Step 8', q: 'Service Revenue has a ‚Ç±50,000 credit balance. The closing entry involves:', options: ['A debit to Service Revenue for ‚Ç±50,000.', 'A credit to Service Revenue for ‚Ç±50,000.', 'A debit to Income Summary for ‚Ç±50,000.', 'A debit to Owner\'s Capital for ‚Ç±50,000.'], a: 'A debit to Service Revenue for ‚Ç±50,000.', s: 'To close a credit-balance account, you must debit it.' },
            { id: 119, type: 'Theory', topic: 'Step 8', q: 'Rent Expense has a ‚Ç±10,000 debit balance. The closing entry involves:', options: ['A debit to Rent Expense for ‚Ç±10,000.', 'A credit to Rent Expense for ‚Ç±10,000.', 'A credit to Income Summary for ‚Ç±10,000.', 'A debit to Owner\'s Capital for ‚Ç±10,000.'], a: 'A credit to Rent Expense for ‚Ç±10,000.', s: 'To close a debit-balance account, you must credit it.' },
            { id: 120, type: 'Theory', topic: 'Step 8', q: 'If a company has a Net Income, the Income Summary account will have a:', options: ['Debit balance (before closing it to Capital).', 'Credit balance (before closing it to Capital).', 'Zero balance.', 'Negative balance.'], a: 'Credit balance (before closing it to Capital).', s: 'Net Income means Revenues (Credits to IS) > Expenses (Debits to IS), leaving a credit balance.' },
            { id: 121, type: 'Theory', topic: 'Step 8', q: 'If a company has a Net Loss, the Income Summary account will have a:', options: ['Debit balance (before closing it to Capital).', 'Credit balance (before closing it to Capital).', 'Zero balance.', 'Positive balance.'], a: 'Debit balance (before closing it to Capital).', s: 'Net Loss means Revenues (Credits to IS) < Expenses (Debits to IS), leaving a debit balance.' },
            { id: 122, type: 'Theory', topic: 'Step 8', q: 'If a company has a Net Income, the closing entry for Income Summary involves:', options: ['A debit to Income Summary and a credit to Owner\'s Capital.', 'A credit to Income Summary and a debit to Owner\'s Capital.', 'A debit to Income Summary and a credit to Cash.', 'A debit to Cash and a credit to Owner\'s Capital.'], a: 'A debit to Income Summary and a credit to Owner\'s Capital.', s: 'This closes the credit balance in Income Summary and transfers the profit to Capital.' },
            { id: 123, type: 'Theory', topic: 'Step 8', q: 'If a company has a Net Loss, the closing entry for Income Summary involves:', options: ['A debit to Income Summary and a credit to Owner\'s Capital.', 'A credit to Income Summary and a debit to Owner\'s Capital.', 'A credit to Income Summary and a debit to Cash.', 'A debit to Owner\'s Capital and a credit to Cash.'], a: 'A credit to Income Summary and a debit to Owner\'s Capital.', s: 'This closes the debit balance in Income Summary and transfers the loss (a reduction) to Capital.' },
            { id: 124, type: 'Theory', topic: 'Step 8', q: 'The closing entry for the Drawings account always involves:', options: ['A debit to Drawings and a credit to Owner\'s Capital.', 'A credit to Drawings and a debit to Owner\'s Capital.', 'A debit to Drawings and a credit to Income Summary.', 'A credit to Drawings and a debit to Income Summary.'], a: 'A credit to Drawings and a debit to Owner\'s Capital.', s: 'Drawings reduce capital, so Capital is debited and the Drawings account is credited to close it.' },
            { id: 125, type: 'Theory', topic: 'Step 8', q: 'Which of the following accounts is NOT closed at the end of the period?', options: ['Salaries Expense.', 'Service Revenue.', 'Owner\'s Drawings.', 'Accounts Payable.'], a: 'Accounts Payable.', s: 'Accounts Payable is a permanent (liability) account.' },

            // Closing Entries (Problems) - 25 Questions
            { id: 126, type: 'Problem', topic: 'Step 8', q: 'Revenues are ‚Ç±80,000. Expenses are ‚Ç±50,000. What is the balance of Income Summary before the 3rd closing entry?', options: ['30000 Credit', '30000 Debit', '130000 Credit', '130000 Debit'], a: '30000 Credit', s: 'Step 1: Credit IS ‚Ç±80,000. Step 2: Debit IS ‚Ç±50,000. Result: ‚Ç±30,000 Credit Balance (Net Income).' },
            { id: 127, type: 'Problem', topic: 'Step 8', q: 'Revenues are ‚Ç±60,000. Expenses are ‚Ç±75,000. What is the balance of Income Summary before the 3rd closing entry?', options: ['15000 Credit', '15000 Debit', '135000 Credit', '135000 Debit'], a: '15000 Debit', s: 'Step 1: Credit IS ‚Ç±60,000. Step 2: Debit IS ‚Ç±75,000. Result: ‚Ç±15,000 Debit Balance (Net Loss).' },
            { id: 128, type: 'Problem', topic: 'Step 8', q: 'Service Revenue is ‚Ç±40,000. Rent Revenue is ‚Ç±5,000. What is the *first* closing entry?', options: ['Debit Income Summary ‚Ç±45,000; Credit Service Revenue ‚Ç±40,000; Credit Rent Revenue ‚Ç±5,000.', 'Debit Service Revenue ‚Ç±40,000; Debit Rent Revenue ‚Ç±5,000; Credit Income Summary ‚Ç±45,000.', 'Debit Owner\'s Capital ‚Ç±45,000; Credit Income Summary ‚Ç±45,000.', 'Debit Income Summary ‚Ç±45,000; Credit Owner\'s Capital ‚Ç±45,000.'], a: 'Debit Service Revenue ‚Ç±40,000; Debit Rent Revenue ‚Ç±5,000; Credit Income Summary ‚Ç±45,000.', s: 'All revenue accounts are debited to close them, and Income Summary is credited for the total.' },
            { id: 129, type: 'Problem', topic: 'Step 8', q: 'Salaries Expense is ‚Ç±20,000. Rent Expense is ‚Ç±10,000. What is the *second* closing entry?', options: ['Debit Income Summary ‚Ç±30,000; Credit Salaries Expense ‚Ç±20,000; Credit Rent Expense ‚Ç±10,000.', 'Debit Salaries Expense ‚Ç±20,000; Debit Rent Expense ‚Ç±10,000; Credit Income Summary ‚Ç±30,000.', 'Debit Owner\'s Capital ‚Ç±30,000; Credit Salaries Expense ‚Ç±20,000; Credit Rent Expense ‚Ç±10,000.', 'Debit Income Summary ‚Ç±30,000; Credit Owner\'s Capital ‚Ç±30,000.'], a: 'Debit Income Summary ‚Ç±30,000; Credit Salaries Expense ‚Ç±20,000; Credit Rent Expense ‚Ç±10,000.', s: 'All expense accounts are credited to close them, and Income Summary is debited for the total.' },
            { id: 130, type: 'Problem', topic: 'Step 8', q: 'Income Summary has a ‚Ç±25,000 credit balance. What is the *third* closing entry?', options: ['Debit Income Summary ‚Ç±25,000; Credit Owner\'s Capital ‚Ç±25,000.', 'Debit Owner\'s Capital ‚Ç±25,000; Credit Income Summary ‚Ç±25,000.', 'Debit Income Summary ‚Ç±25,000; Credit Drawings ‚Ç±25,000.', 'Debit Owner\'s Capital ‚Ç±25,000; Credit Cash ‚Ç±25,000.'], a: 'Debit Income Summary ‚Ç±25,000; Credit Owner\'s Capital ‚Ç±25,000.', s: 'This closes the Income Summary (Net Income) and transfers the profit to Capital.' },
            { id: 131, type: 'Problem', topic: 'Step 8', q: 'Income Summary has a ‚Ç±5,000 debit balance. What is the *third* closing entry?', options: ['Debit Income Summary ‚Ç±5,000; Credit Owner\'s Capital ‚Ç±5,000.', 'Debit Owner\'s Capital ‚Ç±5,000; Credit Income Summary ‚Ç±5,000.', 'Debit Owner\'s Capital ‚Ç±5,000; Credit Drawings ‚Ç±5,000.', 'Debit Cash ‚Ç±5,000; Credit Income Summary ‚Ç±5,000.'], a: 'Debit Owner\'s Capital ‚Ç±5,000; Credit Income Summary ‚Ç±5,000.', s: 'This closes the Income Summary (Net Loss) and transfers the loss to Capital.' },
            { id: 132, type: 'Problem', topic: 'Step 8', q: 'Owner\'s Drawings account has a ‚Ç±12,000 debit balance. What is the *fourth* closing entry?', options: ['Debit Owner\'s Capital ‚Ç±12,000; Credit Owner\'s Drawings ‚Ç±12,000.', 'Debit Owner\'s Drawings ‚Ç±12,000; Credit Owner\'s Capital ‚Ç±12,000.', 'Debit Income Summary ‚Ç±12,000; Credit Owner\'s Drawings ‚Ç±12,000.', 'Debit Owner\'s Capital ‚Ç±12,000; Credit Income Summary ‚Ç±12,000.'], a: 'Debit Owner\'s Capital ‚Ç±12,000; Credit Owner\'s Drawings ‚Ç±12,000.', s: 'This closes the Drawings account and transfers the reduction to Capital.' },
            { id: 133, type: 'Problem', topic: 'Step 8', q: 'Revenues ‚Ç±100,000. Expenses ‚Ç±60,000. Drawings ‚Ç±10,000. Beginning Capital ‚Ç±50,000. What is the ending capital?', options: ['‚Ç±80,000', '‚Ç±100,000', '‚Ç±90,000', '‚Ç±120,000'], a: '‚Ç±80,000', s: 'Beg. Cap (‚Ç±50k) + Net Income (‚Ç±100k - ‚Ç±60k) - Drawings (‚Ç±10k) = ‚Ç±50k + ‚Ç±40k - ‚Ç±10k = ‚Ç±80,000.' },
            { id: 134, type: 'Problem', topic: 'Step 8', q: 'Revenues ‚Ç±70,000. Expenses ‚Ç±80,000. Drawings ‚Ç±5,000. Beginning Capital ‚Ç±40,000. What is the ending capital?', options: ['‚Ç±20,000', '‚Ç±25,000', '‚Ç±35,000', '‚Ç±45,000'], a: '‚Ç±25,000', s: 'Beg. Cap (‚Ç±40k) + Net Loss (‚Ç±70k - ‚Ç±80k) - Drawings (‚Ç±5k) = ‚Ç±40k - ‚Ç±10k - ‚Ç±5k = ‚Ç±25,000.' },
            { id: 135, type: 'Problem', topic: 'Step 8', q: 'What is the total amount debited to Income Summary in the closing process if expenses are ‚Ç±45,000?', options: ['‚Ç±45,000', '‚Ç±90,000', '0', 'The amount of revenues.'], a: '‚Ç±45,000', s: 'The second closing entry is a debit to Income Summary for the total of all expenses.' },
            { id: 136, type: 'Problem', topic: 'Step 8', q: 'What is the total amount credited to Income Summary in the closing process if revenues are ‚Ç±90,000?', options: ['‚Ç±90,000', '‚Ç±45,000', '0', 'The amount of expenses.'], a: '‚Ç±90,000', s: 'The first closing entry is a credit to Income Summary for the total of all revenues.' },
            { id: 137, type: 'Problem', topic: 'Step 8', q: 'If Income Summary is debited for ‚Ç±30,000 (Expenses) and credited for ‚Ç±50,000 (Revenues), what is the third closing entry?', options: ['Debit Income Summary ‚Ç±20,000; Credit Owner\'s Capital ‚Ç±20,000.', 'Debit Owner\'s Capital ‚Ç±20,000; Credit Income Summary ‚Ç±20,000.', 'Debit Income Summary ‚Ç±80,000; Credit Owner\'s Capital ‚Ç±80,000.', 'Debit Owner\'s Capital ‚Ç±80,000; Credit Income Summary ‚Ç±80,000.'], a: 'Debit Income Summary ‚Ç±20,000; Credit Owner\'s Capital ‚Ç±20,000.', s: 'The account has a ‚Ç±20,000 credit balance (Net Income). The entry must debit IS to close it.' },
            { id: 138, type: 'Problem', topic: 'Step 8', q: 'If Income Summary is debited for ‚Ç±60,000 (Expenses) and credited for ‚Ç±55,000 (Revenues), what is the third closing entry?', options: ['Debit Income Summary ‚Ç±5,000; Credit Owner\'s Capital ‚Ç±5,000.', 'Debit Owner\'s Capital ‚Ç±5,000; Credit Income Summary ‚Ç±5,000.', 'Debit Income Summary ‚Ç±115,000; Credit Owner\'s Capital ‚Ç±115,000.', 'Debit Owner\'s Capital ‚Ç±115,000; Credit Income Summary ‚Ç±115,000.'], a: 'Debit Owner\'s Capital ‚Ç±5,000; Credit Income Summary ‚Ç±5,000.', s: 'The account has a ‚Ç±5,000 debit balance (Net Loss). The entry must credit IS to close it.' },
            { id: 139, type: 'Problem', topic: 'Step 8', q: 'Beg. Capital ‚Ç±100,000. End. Capital ‚Ç±120,000. Net Income ‚Ç±30,000. What was the amount of Owner\'s Drawings?', options: ['0', '‚Ç±10,000', '‚Ç±20,000', '‚Ç±50,000'], a: '‚Ç±10,000', s: 'End Cap (‚Ç±120k) = Beg Cap (‚Ç±100k) + NI (‚Ç±30k) - Drawings (x). ‚Ç±120k = ‚Ç±130k - x. x = ‚Ç±10,000.' },
            { id: 140, type: 'Problem', topic: 'Step 8', q: 'Beg. Capital ‚Ç±70,000. End. Capital ‚Ç±60,000. Net Loss ‚Ç±5,000. What was the amount of Owner\'s Drawings?', options: ['0', '‚Ç±5,000', '‚Ç±10,000', '‚Ç±15,000'], a: '‚Ç±5,000', s: 'End Cap (‚Ç±60k) = Beg Cap (‚Ç±70k) - Net Loss (‚Ç±5k) - Drawings (x). ‚Ç±60k = ‚Ç±65k - x. x = ‚Ç±5,000.' },
            { id: 141, type: 'Problem', topic: 'Step 8', q: 'Beg. Capital ‚Ç±80,000. End. Capital ‚Ç±100,000. Drawings ‚Ç±10,000. What was the Net Income or Net Loss?', options: ['Net Income ‚Ç±20,000', 'Net Loss ‚Ç±20,000', 'Net Income ‚Ç±30,000', 'Net Loss ‚Ç±30,000'], a: 'Net Income ‚Ç±30,000', s: 'End Cap (‚Ç±100k) = Beg Cap (‚Ç±80k) + NI/NL (x) - Drawings (‚Ç±10k). ‚Ç±100k = ‚Ç±70k + x. x = ‚Ç±30,000 (Positive, so Net Income).' },
            { id: 142, type: 'Problem', topic: 'Step 8', q: 'Beg. Capital ‚Ç±50,000. End. Capital ‚Ç±40,000. Drawings ‚Ç±0. What was the Net Income or Net Loss?', options: ['Net Income ‚Ç±10,000', 'Net Loss ‚Ç±10,000', 'Net Income ‚Ç±90,000', 'Net Loss ‚Ç±90,000'], a: 'Net Loss ‚Ç±10,000', s: 'End Cap (‚Ç±40k) = Beg Cap (‚Ç±50k) + NI/NL (x) - Drawings (‚Ç±0). ‚Ç±40k = ‚Ç±50k + x. x = -‚Ç±10,000 (Negative, so Net Loss).' },
            { id: 143, type: 'Problem', topic: 'Step 8', q: 'Which account is *not* involved in any of the four closing entries?', options: ['Cash.', 'Service Revenue.', 'Owner\'s Drawings.', 'Income Summary.'], a: 'Cash.', s: 'Cash (Asset), Liabilities, and Capital itself (except as the *target* of NI/Loss/Drawings) are not closed.' },
            { id: 144, type: 'Problem', topic: 'Step 8', q: 'Total Revenues ‚Ç±200,000. Total Expenses ‚Ç±120,000. What is the amount of Net Income?', options: ['‚Ç±80,000', '‚Ç±120,000', '‚Ç±200,000', '‚Ç±320,000'], a: '‚Ç±80,000', s: 'Net Income = Revenues (‚Ç±200,000) - Expenses (‚Ç±120,000) = ‚Ç±80,000.' },
            { id: 145, type: 'Problem', topic: 'Step 8', q: 'Net Income is ‚Ç±45,000. Drawings are ‚Ç±15,000. What is the net *increase* to Owner\'s Capital from the closing process?', options: ['‚Ç±15,000', '‚Ç±30,000', '‚Ç±45,000', '‚Ç±60,000'], a: '‚Ç±30,000', s: 'Capital is increased by Net Income (‚Ç±45,000) and decreased by Drawings (‚Ç±15,000). Net effect = +‚Ç±30,000.' },
            { id: 146, type: 'Problem', topic: 'Step 8', q: 'Net Loss is ‚Ç±10,000. Drawings are ‚Ç±5,000. What is the net *decrease* to Owner\'s Capital from the closing process?', options: ['‚Ç±5,000', '‚Ç±10,000', '‚Ç±15,000', '0'], a: '‚Ç±15,000', s: 'Capital is decreased by Net Loss (‚Ç±10,000) and decreased by Drawings (‚Ç±5,000). Total decrease = ‚Ç±15,000.' },
            { id: 147, type: 'Problem', topic: 'Step 8', q: 'Income Summary has a ‚Ç±15,000 credit balance. Drawings are ‚Ç±20,000. What is the net change to Owner\'s Capital?', options: ['Increase ‚Ç±5,000', 'Decrease ‚Ç±5,000', 'Increase ‚Ç±35,000', 'Decrease ‚Ç±35,000'], a: 'Decrease ‚Ç±5,000', s: 'Capital increases by ‚Ç±15,000 (Net Income) and decreases by ‚Ç±20,000 (Drawings). Net effect = -‚Ç±5,000.' },
            { id: 148, type: 'Problem', topic: 'Step 8', q: 'Income Summary has a ‚Ç±10,000 debit balance. Drawings are ‚Ç±2,000. What is the net change to Owner\'s Capital?', options: ['Decrease ‚Ç±8,000', 'Increase ‚Ç±8,000', 'Decrease ‚Ç±12,000', 'Increase ‚Ç±12,000'], a: 'Decrease ‚Ç±12,000', s: 'Capital decreases by ‚Ç±10,000 (Net Loss) and decreases by ‚Ç±2,000 (Drawings). Net effect = -‚Ç±12,000.' },
            { id: 149, type: 'Problem', topic: 'Step 8', q: 'After closing Revenues (‚Ç±50k) and Expenses (‚Ç±30k), what is the balance of Income Summary?', options: ['20000 Credit', '20000 Debit', '80000 Credit', '80000 Debit'], a: '20000 Credit', s: 'Credit IS ‚Ç±50,000 (from Revenues), Debit IS ‚Ç±30,000 (from Expenses). Balance = ‚Ç±20,000 Credit.' },
            { id: 150, type: 'Problem', topic: 'Step 8', q: 'After all four closing entries, what is the balance of the Income Summary account?', options: ['The Net Income amount.', 'The Net Loss amount.', 'Zero.', 'The beginning capital amount.'], a: 'Zero.', s: 'Income Summary is a temporary clearing account. It is opened and closed during the closing process, ending at zero.' },

            // Post-Closing Trial Balance (PCTB) - 20 Questions
            { id: 151, type: 'Theory', topic: 'Step 9', q: 'What is the purpose of the Post-Closing Trial Balance (PCTB)?', options: ['To calculate the net income for the period.', 'To list all transactions for the period.', 'To verify that debits equal credits and that only permanent accounts remain open.', 'To prepare adjusting entries.'], a: 'To verify that debits equal credits and that only permanent accounts remain open.', s: 'It\'s a final check after closing entries to ensure all temporary accounts are zero.' },
            { id: 152, type: 'Theory', topic: 'Step 9', q: 'Which of the following accounts would *appear* on a Post-Closing Trial Balance?', options: ['Service Revenue.', 'Prepaid Insurance.', 'Salaries Expense.', 'Owner\'s Drawings.'], a: 'Prepaid Insurance.', s: 'Prepaid Insurance is an Asset (a permanent account).' },
            { id: 153, type: 'Theory', topic: 'Step 9', q: 'Which of the following accounts would *NOT* appear on a Post-Closing Trial Balance?', options: ['Cash.', 'Accounts Payable.', 'Service Revenue.', 'Owner\'s Capital.'], a: 'Service Revenue.', s: 'Service Revenue is a temporary account and would have a zero balance after closing.' },
            { id: 154, type: 'Theory', topic: 'Step 9', q: 'Which of the following accounts would *NOT* appear on a Post-Closing Trial Balance?', options: ['Salaries Expense.', 'Equipment.', 'Accumulated Depreciation.', 'Unearned Revenue.'], a: 'Salaries Expense.', s: 'Salaries Expense is a temporary account and would have a zero balance after closing.' },
            { id: 155, type: 'Theory', topic: 'Step 9', q: 'Which of the following accounts would *NOT* appear on a Post-Closing Trial Balance?', options: ['Owner\'s Drawings.', 'Supplies.', 'Salaries Payable.', 'Owner\'s Capital.'], a: 'Owner\'s Drawings.', s: 'Drawings is a temporary account and would have a zero balance after closing.' },
            { id: 156, type: 'Theory', topic: 'Step 9', q: 'The balances on the Post-Closing Trial Balance are used for what purpose?', options: ['They are transferred to the Income Statement.', 'They become the beginning balances for the next accounting period.', 'They are used to calculate net income.', 'They are discarded after printing.'], a: 'They become the beginning balances for the next accounting period.', s: 'The PCTB represents the starting point (Assets, Liabilities, Equity) for the new period.' },
            { id: 157, type: 'Theory', topic: 'Step 9', q: 'The Owner\'s Capital account on the PCTB reflects which balance?', options: ['The beginning capital balance for the period.', 'The ending capital balance for the period.', 'The total revenues for the period.', 'A zero balance.'], a: 'The ending capital balance for the period.', s: 'After closing net income/loss and drawings, the Capital account is at its final ending balance.' },
            { id: 158, type: 'Theory', topic: 'Step 9', q: 'The Post-Closing Trial Balance contains *only* which types of accounts?', options: ['Revenues, Expenses, and Drawings.', 'Assets, Liabilities, and Equity.', 'Assets, Revenues, and Expenses.', 'Liabilities, Equity, and Revenues.'], a: 'Assets, Liabilities, and Equity.', s: 'These are the permanent (real) accounts, which form the Balance Sheet.' },
            { id: 159, type: 'Theory', topic: 'Step 9', q: 'Which trial balance lists the greatest number of accounts?', options: ['Unadjusted Trial Balance.', 'Adjusted Trial Balance.', 'Post-Closing Trial Balance.', 'All trial balances list the same number.'], a: 'Adjusted Trial Balance.', s: 'The ATB lists all accounts (permanent and temporary) *after* adjustments but *before* closing.' },
            { id: 160, type: 'Theory', topic: 'Step 9', q: 'Which account balance on the PCTB is the direct result of the closing process?', options: ['Cash.', 'Accounts Payable.', 'Owner\'s Capital.', 'Equipment.'], a: 'Owner\'s Capital.', s: 'The closing process updates the Owner\'s Capital account to its new ending balance.' },
            { id: 161, type: 'Problem', topic: 'Step 9', q: 'A PCTB has Total Debits of ‚Ç±50,000. What must be the Total Credits?', options: ['0', '‚Ç±25,000', '‚Ç±50,000', '‚Ç±100,000'], a: '‚Ç±50,000', s: 'The purpose of any trial balance is to prove that debits equal credits.' },
            { id: 162, type: 'Problem', topic: 'Step 9', q: 'A company\'s PCTB shows: Cash ‚Ç±5,000; Equipment ‚Ç±10,000; Accounts Payable ‚Ç±3,000. What is the balance of Owner\'s Capital?', options: ['‚Ç±10,000', '‚Ç±12,000', '‚Ç±15,000', '‚Ç±18,000'], a: '‚Ç±12,000', s: 'Assets (‚Ç±5k + ‚Ç±10k) = Liabilities (‚Ç±3k) + Equity (x). ‚Ç±15,000 = ‚Ç±3,000 + x. x = ‚Ç±12,000.' },
            { id: 163, type: 'Problem', topic: 'Step 9', q: 'Which of these accounts would have a *credit* balance on the PCTB?', options: ['Cash.', 'Accumulated Depreciation.', 'Prepaid Rent.', 'Equipment.'], a: 'Accumulated Depreciation.', s: 'Accumulated Depreciation is a contra-asset, a permanent account with a normal credit balance.' },
            { id: 164, type: 'Problem', topic: 'Step 9', q: 'Which of these accounts would have a *credit* balance on the PCTB?', options: ['Accounts Receivable.', 'Supplies.', 'Salaries Payable.', 'Owner\'s Drawings (if it appeared).'], a: 'Salaries Payable.', s: 'Salaries Payable is a Liability, a permanent account with a normal credit balance.' },
            { id: 165, type: 'Problem', topic: 'Step 9', q: 'An Adjusted Trial Balance shows: Cash ‚Ç±10k, Service Revenue ‚Ç±20k, Rent Expense ‚Ç±5k, Owner\'s Capital ‚Ç±(X). Which accounts will *not* be on the PCTB?', options: ['Cash and Owner\'s Capital.', 'Cash and Service Revenue.', 'Service Revenue and Rent Expense.', 'Owner\'s Capital and Rent Expense.'], a: 'Service Revenue and Rent Expense.', s: 'These are temporary accounts that will be closed and have a zero balance.' },
            { id: 166, type: 'Problem', topic: 'Step 9', q: 'A company\'s total assets on the PCTB are ‚Ç±100,000. Total liabilities are ‚Ç±40,000. What is the total Owner\'s Equity?', options: ['‚Ç±40,000', '‚Ç±60,000', '‚Ç±100,000', '‚Ç±140,000'], a: '‚Ç±60,000', s: 'Assets (‚Ç±100,000) = Liabilities (‚Ç±40,000) + Equity (x). x = ‚Ç±60,000.' },
            { id: 167, type: 'Theory', topic: 'Step 9', q: 'If the Post-Closing Trial Balance does *not* balance, what is the most likely error?', options: ['An error was made in posting the adjusting entries.', 'An error was made in posting the closing entries.', 'An error was made in preparing the Income Statement.', 'An error was made in journalizing daily transactions.'], a: 'An error was made in posting the closing entries.', s: 'This is the most common reason, as the ATB (which comes before closing) is assumed to have balanced.' },
            { id: 168, type: 'Theory', topic: 'Step 9', q: 'The accounts on the Post-Closing Trial Balance are identical to the accounts on which financial statement?', options: ['The Income Statement.', 'The Balance Sheet.', 'The Statement of Changes in Equity.', 'The Statement of Cash Flows.'], a: 'The Balance Sheet.', s: 'The PCTB is essentially a trial balance of the Balance Sheet accounts.' },
            { id: 169, type: 'Problem', topic: 'Step 9', q: 'ATB shows: Cash ‚Ç±10k, Accounts Receivable ‚Ç±5k, Supplies ‚Ç±1k, Accounts Payable ‚Ç±3k, Capital ‚Ç±13k. (Revenues/Expenses/Drawings balanced). What are total debits on the PCTB?', options: ['‚Ç±13,000', '‚Ç±15,000', '‚Ç±16,000', '‚Ç±29,000'], a: '‚Ç±16,000', s: 'The permanent debit accounts are Cash (‚Ç±10k) + A/R (‚Ç±5k) + Supplies (‚Ç±1k) = ‚Ç±16,000.' },
            { id: 170, type: 'Problem', topic: 'Step 9', q: 'Using Q169 data, what are the total credits on the PCTB?', options: ['‚Ç±3,000', '‚Ç±13,000', '‚Ç±16,000', '‚Ç±29,000'], a: '‚Ç±16,000', s: 'The permanent credit accounts are A/P (‚Ç±3k) + Capital (‚Ç±13k) = ‚Ç±16,000. Debits equal credits.' },
            
            // Reversing Entries - 30 Questions
            { id: 171, type: 'Theory', topic: 'Step 10', q: 'When are reversing entries prepared?', options: ['On the last day of the accounting period.', 'On the first day of the new accounting period.', 'After preparing the income statement.', 'Before preparing closing entries.'], a: 'On the first day of the new accounting period.', s: 'They are dated the day after the previous period ends (e.g., January 1).' },
            { id: 172, type: 'Theory', topic: 'Step 10', q: 'What is the primary purpose of reversing entries?', options: ['To correct errors from the prior period.', 'To simplify bookkeeping for routine entries in the new period.', 'To calculate net income.', 'To close the temporary accounts.'], a: 'To simplify bookkeeping for routine entries in the new period.', s: 'They are an optional step for convenience, not a required part of GAAP/PFRS.' },
            { id: 173, type: 'Theory', topic: 'Step 10', q: 'Are reversing entries optional or mandatory?', options: ['Optional.', 'Mandatory under PFRS.', 'Mandatory under GAAP.', 'Mandatory for all businesses.'], a: 'Optional.', s: 'They are a bookkeeping convenience and not required by accounting standards.' },
            { id: 174, 'type': 'Theory', topic: 'Step 10', q: 'A reversing entry is the exact opposite of what?', options: ['A closing entry.', 'A correcting entry.', 'An adjusting entry from the prior period.', 'A regular transaction.'], a: 'An adjusting entry from the prior period.', s: 'The debits and credits of the adjusting entry are "reversed" or "flipped".' },
            { id: 175, 'type': 'Theory', topic: 'Step 10', q: 'Which *type* of adjusting entry is *always* a candidate for reversal?', options: ['All deferrals.', 'All accruals (both accrued expenses and accrued revenues).', 'Depreciation and Bad Debts.', 'Corrections of errors.'], a: 'All accruals (both accrued expenses and accrued revenues).', s: 'Reversing accruals simplifies the subsequent cash payment or receipt.' },
            { id: 176, type: 'Theory', topic: 'Step 10', q: 'Which adjusting entry is *never* reversed?', options: ['Accrued Salaries.', 'Accrued Interest Revenue.', 'Depreciation Expense.', 'Prepaid Expense (Expense Method).'], a: 'Depreciation Expense.', s: 'Reversing depreciation would make no logical sense and would disrupt the Accumulated Depreciation balance.' },
            { id: 177, type: 'Theory', topic: 'Step 10', q: 'Which adjusting entry is *never* reversed?', options: ['Accrued Utilities Expense.', 'Bad Debt Expense.', 'Accrued Service Revenue.', 'Unearned Revenue (Revenue Method).'], a: 'Bad Debt Expense.', s: 'Reversing bad debt expense would distort the Allowance for Doubtful Accounts.' },
            { id: 178, type: 'Theory', topic: 'Step 10', q: 'If an adjusting entry for *accrued salaries* (Salaries Expense Dr, Salaries Payable Cr) is made, what is the reversing entry?', options: ['Debit Salaries Expense; Credit Salaries Payable.', 'Debit Salaries Payable; Credit Salaries Expense.', 'Debit Salaries Payable; Credit Cash.', 'Debit Owner\'s Capital; Credit Salaries Expense.'], a: 'Debit Salaries Payable; Credit Salaries Expense.', s: 'It is the exact opposite of the adjusting entry.' },
            { id: 179, type: 'Theory', topic: 'Step 10', q: 'If an adjusting entry for *accrued interest revenue* (Interest Receivable Dr, Interest Revenue Cr) is made, what is the reversing entry?', options: ['Debit Interest Revenue; Credit Interest Receivable.', 'Debit Interest Receivable; Credit Interest Revenue.', 'Debit Cash; Credit Interest Receivable.', 'Debit Interest Revenue; Credit Owner\'s Capital.'], a: 'Debit Interest Revenue; Credit Interest Receivable.', s: 'It is the exact opposite of the adjusting entry.' },
            { id: 180, type: 'Theory', topic: 'Step 10', q: 'What is the effect of a reversing entry for accrued salaries (Debit Salaries Payable, Credit Salaries Expense)?', options: ['It puts a temporary debit balance in the Salaries Expense account.', 'It puts a temporary credit balance in the Salaries Expense account.', 'It increases the Salaries Payable account.', 'It has no effect on the expense account.'], a: 'It puts a temporary credit balance in the Salaries Expense account.', s: 'This credit balance will be offset by the larger debit when the full payroll is paid.' },
            { id: 181, type: 'Theory', topic: 'Step 10', q: 'If a company reverses its deferrals, which *method* must they be using?', options: ['The Asset Method (for prepaid expenses) or the Liability Method (for unearned revenue).', 'The Expense Method (for prepaid expenses) or the Revenue Method (for unearned revenue).', 'The Accrual Method.', 'The Cash Method.'], a: 'The Expense Method (for prepaid expenses) or the Revenue Method (for unearned revenue).', s: 'Deferrals recorded using the Asset Method or Liability Method are typically *not* reversed.' },
            { id: 182, type: 'Theory', topic: 'Step 10', q: 'Adjusting Entry (Asset Method): Debit Insurance Expense, Credit Prepaid Insurance. Should this be reversed?', options: ['Yes, always.', 'Yes, to simplify bookkeeping.', 'No, adjustments from the asset/liability method are not typically reversed.', 'Only if the amount is large.'], a: 'No, adjustments from the asset/liability method are not typically reversed.', s: 'There is no simplification benefit, as the asset account correctly reflects the balance.' },
            { id: 183, type: 'Theory', topic: 'Step 10', q: 'Adjusting Entry (Expense Method): Debit Prepaid Insurance, Credit Insurance Expense. Should this be reversed?', options: ['Yes, this is a candidate for reversal.', 'No, this is never reversed.', 'No, because it affects an asset.', 'Only if the company makes a profit.'], a: 'Yes, this is a candidate for reversal.', s: 'Reversing this (Debit Ins. Exp, Credit Prepaid Ins) returns the full expense to the expense account, simplifying future adjustments.' },
            { id: 184, type: 'Theory', topic: 'Step 10', q: 'Adjusting Entry: Debit Supplies Expense, Credit Supplies. Should this be reversed?', options: ['Yes, always.', 'No.', 'Only if supplies are purchased on account.', 'Only if the company uses the expense method.'], a: 'No.', s: 'This adjustment, based on a physical count, is almost never reversed.' },
            { id: 185, type: 'Theory', topic: 'Step 10', q: 'If a company *does not* use reversing entries, what must the bookkeeper do when paying the next payroll (which includes a prior-period accrual)?', options: ['Record the entire payment as Salaries Expense for the new period.', 'Split the entry (e.g., Debit Salaries Payable, Debit Salaries Expense, Credit Cash).', 'Record the entire payment as Salaries Payable.', 'Wait until the end of the new period to record the payment.'], a: 'Split the entry (e.g., Debit Salaries Payable, Debit Salaries Expense, Credit Cash).', s: 'The bookkeeper must remember to clear the payable and expense only the new period\'s portion.' },
            { id: 186, type: 'Problem', topic: 'Step 10', q: 'Adjusting Journal Entry: Debit Salaries Expense ‚Ç±3,000; Credit Salaries Payable ‚Ç±3,000. What is the Jan 1 reversing entry?', options: ['Debit Salaries Expense ‚Ç±3,000; Credit Salaries Payable ‚Ç±3,000.', 'Debit Salaries Payable ‚Ç±3,000; Credit Salaries Expense ‚Ç±3,000.', 'Debit Salaries Payable ‚Ç±3,000; Credit Cash ‚Ç±3,000.', 'No entry is needed.'], a: 'Debit Salaries Payable ‚Ç±3,000; Credit Salaries Expense ‚Ç±3,000.', s: 'The entry is flipped.' },
            { id: 187, type: 'Problem', topic: 'Step 10', q: 'Adjusting Journal Entry: Debit Interest Receivable ‚Ç±500; Credit Interest Revenue ‚Ç±500. What is the Jan 1 reversing entry?', options: ['Debit Interest Receivable ‚Ç±500; Credit Interest Revenue ‚Ç±500.', 'Debit Cash ‚Ç±500; Credit Interest Receivable ‚Ç±500.', 'Debit Interest Revenue ‚Ç±500; Credit Interest Receivable ‚Ç±500.', 'No entry is needed.'], a: 'Debit Interest Revenue ‚Ç±500; Credit Interest Receivable ‚Ç±500.', s: 'The entry is flipped.' },
           { id: 191, type: 'Problem', topic: 'Step 10', q: '(No Reversing Entry) Adjusting Journal Entry: Debit Salaries Expense ‚Ç±3,000; Credit Salaries Payable ‚Ç±3,000. On Jan 5, the company pays the full ‚Ç±8,000 payroll. What is the entry?', options: ['Debit Salaries Expense ‚Ç±8,000; Credit Cash ‚Ç±8,000.', 'Debit Salaries Payable ‚Ç±3,000; Debit Salaries Expense ‚Ç±5,000; Credit Cash ‚Ç±8,000.', 'Debit Salaries Payable ‚Ç±8,000; Credit Cash ‚Ç±8,000.', 'Debit Salaries Expense ‚Ç±5,000; Credit Cash ‚Ç±5,000.'], a: 'Debit Salaries Payable ‚Ç±3,000; Debit Salaries Expense ‚Ç±5,000; Credit Cash ‚Ç±8,000.', s: 'Without a reversing entry, the bookkeeper must manually split the payment to clear the liability and record the new expense.' },
            { id: 192, type: 'Problem', topic: 'Step 10', q: 'Adjusting Journal Entry: Debit Depreciation Expense ‚Ç±1,000; Credit Accumulated Depreciation ‚Ç±1,000. What is the reversing entry?', options: ['Debit Accumulated Depreciation ‚Ç±1,000; Credit Depreciation Expense ‚Ç±1,000.', 'Debit Depreciation Expense ‚Ç±1,000; Credit Accumulated Depreciation ‚Ç±1,000.', 'None (This entry is not reversed).', 'Debit Owner\'s Capital ‚Ç±1,000; Credit Depreciation Expense ‚Ç±1,000.'], a: 'None (This entry is not reversed).', s: 'Depreciation is a non-cash allocation and is never reversed.' },
            { id: 193, type: 'Problem', topic: 'Step 10', q: 'Adjusting Journal Entry: Debit Bad Debt Expense ‚Ç±700; Credit Allowance for Doubtful Accounts ‚Ç±700. What is the reversing entry?', options: ['Debit Allowance for Doubtful Accounts ‚Ç±700; Credit Bad Debt Expense ‚Ç±700.', 'Debit Bad Debt Expense ‚Ç±700; Credit Allowance for Doubtful Accounts ‚Ç±700.', 'None (This entry is not reversed).', 'Debit Owner\'s Capital ‚Ç±700; Credit Bad Debt Expense ‚Ç±700.'], a: 'None (This entry is not reversed).', s: 'Estimates for bad debts are not reversed.' },
            { id: 194, type: 'Problem', topic: 'Step 10', q: 'Adjusting Journal Entry (Liability Method): Debit Unearned Revenue ‚Ç±400; Credit Service Revenue ‚Ç±400. What is the reversing entry?', options: ['Debit Service Revenue ‚Ç±400; Credit Unearned Revenue ‚Ç±400.', 'None (This entry is not typically reversed).', 'Debit Unearned Revenue ‚Ç±400; Credit Service Revenue ‚Ç±400.', 'Debit Cash ‚Ç±400; Credit Unearned Revenue ‚Ç±400.'], a: 'None (This entry is not typically reversed).', s: 'Adjustments from the liability (or asset) method are not reversed as they correctly state the balance sheet accounts.' },
            { id: 195, type: 'Problem', topic: 'Step 10', q: 'Adjusting Journal Entry: Debit Supplies Expense ‚Ç±600; Credit Supplies ‚Ç±600. What is the reversing entry?', options: ['Debit Supplies ‚Ç±600; Credit Supplies Expense ‚Ç±600.', 'None (This entry is not reversed).', 'Debit Supplies Expense ‚Ç±600; Credit Supplies ‚Ç±600.', 'Debit Owner\'s Capital ‚Ç±600; Credit Supplies Expense ‚Ç±600.'], a: 'None (This entry is not reversed).', s: 'This adjustment, based on a physical count, is not reversed.' },
            { id: 196, type: 'Theory', topic: 'Step 10', q: 'Reversing entries are posted to the:', options: ['Worksheet only.', 'General Journal and General Ledger.', 'Financial Statements only.', 'Adjusted Trial Balance only.'], a: 'General Journal and General Ledger.', s: 'Like any journal entry, they must be journalized and then posted to update the ledger.' },
            { id: 197, type: 'Theory', topic: 'Step 10', q: 'If a company *forgets* to make a reversing entry, what is the result?', options: ['The financial statements for the prior year will be wrong.', 'No financial error, but the first transaction of the next period may be recorded incorrectly if the bookkeeper is not careful.', 'The company will report a net loss.', 'The post-closing trial balance will not balance.'], a: 'No financial error, but the first transaction of the next period may be recorded incorrectly if the bookkeeper is not careful.', s: 'It\'s a bookkeeping convenience. The risk is a human error in the next period, not a flaw in the system.' },
        ];
        
        // --- STATE MANAGEMENT ---
        let activeTestParts = { 1: [], 2: [], 3: [] };
        let currentPart = 1;
        let currentQuestionIndex = 0;
        let studentInfo = {};
        let studentAnswers = { 1: {}, 2: {}, 3: {} };
        let timerInterval;
        let timeRemaining; // Seconds

        // --- INITIALIZATION LOGIC ---
        window.initializeTest = function() {
            const cn = document.getElementById('class-number').value.trim();
            const fn = document.getElementById('full-name').value.trim();
            const gs = document.getElementById('grade-section').value.trim();
            const idNumber = document.getElementById('id-number').value.trim();

            if(!cn || !fn || !gs) {
                alert("Please complete verification first.");
                return;
            }

            studentInfo = { cn, fn, gs, idNumber };
            document.getElementById('student-display-name').innerText = `${fn} (${gs})`;
            document.getElementById('student-info-section').classList.add('hidden');
            document.getElementById('main-interface').classList.remove('hidden');
            document.body.classList.remove('no-scroll');
            document.getElementById('timer-bar').classList.remove('hidden');

            generateQuestions();
            renderQuestionUI();
            startTimer();
        }

        function startTimer() {
            timeRemaining = window.examDurationMins * 60;
            updateTimerDisplay();
            timerInterval = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    alert("Time is up! Submitting your answers.");
                    // AUTO SUBMIT UPON EXPIRATION
                    window.finishAndPreview(true);
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const h = Math.floor(timeRemaining / 3600);
            const m = Math.floor((timeRemaining % 3600) / 60);
            const s = timeRemaining % 60;
            document.getElementById('timer-display').innerText = 
                `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
            
            if(timeRemaining < 300) { // Red alert last 5 mins
                document.getElementById('timer-bar').classList.add('animate-pulse');
            }
        }

        function generateQuestions() {
            // Logic matches original provided logic
            const pool1 = allQuestionsPool.filter(q => q.topic === 'Adjustments');
            const pool2 = allQuestionsPool.filter(q => q.topic === 'Worksheet' || q.topic === 'Statements');
            const pool3 = allQuestionsPool.filter(q => ['Step 7', 'Step 8', 'Step 9', 'Step 10'].includes(q.topic));

            activeTestParts[1] = getRandomSubset(pool1, 25);
            activeTestParts[2] = getRandomSubset(pool2, 25);
            activeTestParts[3] = getRandomSubset(pool3, 25);
        }

        function getRandomSubset(arr, size) {
            // If pool is smaller than requested size (for testing), return all
            if (arr.length <= size) return arr;
            const shuffled = [...arr].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, size);
        }

        // --- NAVIGATION LOGIC ---
        window.switchTestPart = function(partNum) {
            currentPart = partNum;
            currentQuestionIndex = 0;
            renderQuestionUI();
        }

        window.nextQuestion = function() {
            if(currentQuestionIndex < activeTestParts[currentPart].length - 1) {
                currentQuestionIndex++;
                renderQuestionUI();
            }
        }

        window.prevQuestion = function() {
            if(currentQuestionIndex > 0) {
                currentQuestionIndex--;
                renderQuestionUI();
            }
        }

        window.jumpToQuestion = function(index) {
            currentQuestionIndex = index;
            renderQuestionUI();
        }

        // --- RENDERING LOGIC ---
        function renderQuestionUI() {
            // Update Tabs
            [1, 2, 3].forEach(n => {
                const tab = document.getElementById(`tab-${n}`);
                if(n === currentPart) {
                    tab.classList.add('text-blue-800', 'border-blue-500', 'bg-white');
                    tab.classList.remove('text-gray-500', 'border-transparent');
                } else {
                    tab.classList.remove('text-blue-800', 'border-blue-500', 'bg-white');
                    tab.classList.add('text-gray-500', 'border-transparent');
                }
            });

            const questions = activeTestParts[currentPart];
            if(questions.length === 0) return;

            const q = questions[currentQuestionIndex];
            let optionsHtml = '';
            
            q.options.forEach((opt, i) => {
                const isChecked = studentAnswers[currentPart][q.id] === opt ? 'checked' : '';
                optionsHtml += `
                    <label class="flex items-start p-3 border rounded-lg hover:bg-blue-50 cursor-pointer transition-colors ${isChecked ? 'bg-blue-50 border-blue-400' : 'border-gray-200'}">
                        <input type="radio" name="q_${q.id}" value="${opt.replace(/"/g, '&quot;')}" 
                            onchange="saveAnswer(${q.id}, this.value)" class="mt-1 mr-3 text-blue-600" ${isChecked}>
                        <span class="text-gray-700 text-sm md:text-base font-serif">${opt}</span>
                    </label>
                `;
            });

            document.getElementById('question-content').innerHTML = `
                <div class="mb-4">
                    <span class="inline-block px-2 py-1 text-xs font-semibold text-blue-800 bg-blue-100 rounded mb-2">
                        ${q.type} - ${q.topic}
                    </span>
                    <h3 class="text-lg md:text-xl font-bold text-gray-800 leading-relaxed font-serif">
                        ${currentQuestionIndex + 1}. ${q.q}
                    </h3>
                </div>
                <div class="space-y-3">
                    ${optionsHtml}
                </div>
            `;

            document.getElementById('btn-prev').disabled = currentQuestionIndex === 0;
            document.getElementById('btn-prev').classList.toggle('opacity-50', currentQuestionIndex === 0);
            
            document.getElementById('btn-next').disabled = currentQuestionIndex === questions.length - 1;
            document.getElementById('btn-next').classList.toggle('opacity-50', currentQuestionIndex === questions.length - 1);

            document.getElementById('question-counter').innerText = `${currentQuestionIndex + 1} / ${questions.length}`;

            // Render Palette
            const palette = document.getElementById('question-palette');
            palette.innerHTML = '';
            questions.forEach((que, idx) => {
                const hasAnswer = studentAnswers[currentPart][que.id] !== undefined;
                const isActive = idx === currentQuestionIndex;
                let classes = 'q-dot';
                if (isActive) classes += ' active';
                if (hasAnswer) classes += ' answered';
                
                palette.innerHTML += `<div class="${classes}" onclick="window.jumpToQuestion(${idx})">${idx + 1}</div>`;
            });
        }

        window.saveAnswer = function(qId, value) {
            studentAnswers[currentPart][qId] = value;
            renderQuestionUI();
        }

        // --- GRADING, SUBMISSION & PRINTING LOGIC ---

        // NEW LOGIC: Submit first, then preview/download
        window.finishAndPreview = async function(isAutoSubmit = false) {
            if(!isAutoSubmit) {
                if(!confirm("Are you sure you want to submit your exam? You cannot change answers after this.")) return;
            }

            // Stop Timer
            clearInterval(timerInterval);
            document.getElementById('timer-bar').classList.add('hidden');

            // Prepare Data
            const fullData = {
                studentInfo: studentInfo,
                answers: studentAnswers,
                questions: activeTestParts,
                timestamp: new Date().toISOString(),
                scoreData: calculateScores()
            };

            // 1. SUBMIT TO FIREBASE
            const saved = await window.saveResultsToFirebase(fullData);

            if (saved) {
                // 2. GENERATE REPORT AND SHOW MODAL
                generateReportHTML();
                document.getElementById('print-preview-modal').classList.remove('hidden');
                
                // 3. UPDATE BUTTONS (No "Keep Answering", Only "Download PDF")
                const actionsDiv = document.getElementById('preview-actions');
                actionsDiv.innerHTML = `
                    <button onclick="window.downloadPDF()" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 font-bold font-serif shadow-md">
                        Download PDF Result
                    </button>
                `;
                
                // Hide the overlay (it was shown by saveResultsToFirebase)
                document.getElementById('submission-overlay').classList.add('hidden');
            } else {
                // If failed, remove overlay so they can try again.
                document.getElementById('submission-overlay').classList.add('hidden');
                // Re-enable manual submit if it wasn't auto (auto failed = stuck, but user can see error and try refreshing or manual)
                if (!isAutoSubmit) {
                     document.getElementById('timer-bar').classList.remove('hidden');
                     startTimer();
                }
            }
        }

        function calculateScores() {
           let scores = {};
           [1,2,3].forEach(part => {
                scores[part] = gradePart(part);
           });
           return scores;
        }

        function gradePart(partNum) {
            const questions = activeTestParts[partNum];
            let score = 0;
            const graded = questions.map(q => {
                const ans = studentAnswers[partNum][q.id];
                // Fix for Firebase error: Ensure ans is not undefined
                const cleanAns = (ans === undefined) ? null : ans;
                
                const isCorrect = ans === q.a;
                if(isCorrect) score++;
                return { ...q, studentAns: cleanAns, isCorrect };
            });
            return { score, total: questions.length, details: graded };
        }

        function getLetterGrade(percentage) {
            if(percentage >= 95) return 'A';
            if(percentage >= 85) return 'P';
            if(percentage >= 75) return 'D';
            return 'IR'; 
        }

        function generateReportHTML() {
            const container = document.getElementById('print-content');
            const date = new Date().toLocaleDateString();
            const timeStr = new Date().toLocaleTimeString();

            let html = `
            <div class="text-center border-b-2 border-gray-800 pb-4 mb-6 font-serif">
              <div class="flex justify-center mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-16 w-16 text-blue-900">
                        <path d="M11.7 2.805a.75.75 0 01.6 0A60.65 60.65 0 0122.83 8.72a.75.75 0 01-.231 1.337 49.949 49.949 0 00-9.902 3.912l-.003.002-.34.18a.75.75 0 01-.707 0A50.009 50.009 0 001.402 10.06a.75.75 0 01-.231-1.337A60.653 60.653 0 0111.7 2.805z" />
                        <path d="M13.06 15.473a48.45 48.45 0 017.666-3.282c.134 1.414.22 2.843.255 4.286a.75.75 0 01-.46.71 47.878 47.878 0 00-8.105 4.342.75.75 0 01-.832 0 47.877 47.877 0 00-8.104-4.342.75.75 0 01-.461-.71c.035-1.442.121-2.87.255-4.286A48.4 48.4 0 0110.94 15.473a.75.75 0 001.06 0z" />
                        <path d="M4.75 17.25a.75.75 0 01.75.75v2.25c0 .138.112.25.25.25h2.5a.75.75 0 010 1.5h-2.5a1.75 1.75 0 01-1.75-1.75v-2.25a.75.75 0 01.75-.75z" />
                    </svg>
              </div>
              <img src="./shs-adc-logo.png" alt="School Logo" class="mx-auto mb-2 h-20 w-auto" />
              <p class="text-sm mt-1">SY 2025-2026 | 2nd Semester</p>
              <h1 class="text-xl font-bold uppercase mt-2">T2 Summative Test 01</h1>
              <h1 class="text-2xl font-bold uppercase mb-4">FABM 1</h1>

              <div class="flex justify-between text-sm mt-1 text-left border-t border-gray-300 pt-2">
                <div>
                    <p>CN: <b>${studentInfo.cn}</b></p>
                    <p>Name: <b>${studentInfo.fn}</b></p>
                </div>
                <div class="text-right">
                    <p>Section: <b>${studentInfo.gs}</b></p>
                    <p>Date: ${date} ${timeStr}</p>
                </div>
              </div>
            </div>
            `;

            const competencies = {
                1: "To analyze the effects of accrual and deferral transactions to the account balances, and net income or loss.",
                2: "To create the 10-Columns worksheet.",
                3: "To remember the significant purpose and procedures of the closing stage of the accounting cycle."
            };

            const parts = [
                { id: 1, title: "Test 1: Accrual & Deferral Adjustments" },
                { id: 2, title: "Test 2: Worksheet & Financial Statements" },
                { id: 3, title: "Test 3: Closing, Post-Closing & Reversing" }
            ];

            let overallScore = 0;
            let overallTotal = 0;

            parts.forEach(part => {
                const result = gradePart(part.id);
                overallScore += result.score;
                overallTotal += result.total;
                const pct = result.total > 0 ? ((result.score / result.total) * 100).toFixed(1) : 0;
                const partLetterGrade = getLetterGrade(pct);

                html += `
                    <div class="mb-8 break-inside-avoid font-serif">
                        <div class="bg-gray-100 p-3 rounded-t mb-0 flex justify-between items-center border-l-4 border-blue-600">
                            <h2 class="font-bold text-lg">${part.title}</h2>
                            <span class="font-bold text-blue-800">${result.score} / ${result.total} (${pct}%) - Grade: ${partLetterGrade}</span>
                        </div>
                        
                        <div class="print-rubric rounded-b border-t-0">
                            <div class="mb-1"><strong>Competency:</strong> ${competencies[part.id]}</div>
                            <div><strong>Criteria:</strong> 95-100%(A), 85-94.9%(P), 75-84.9%(D), <75%(IR)</div>
                        </div>
                `;

                result.details.forEach((item, idx) => {
                    // LOGIC CHANGE: Handle Unanswered Questions
                    let statusHtml = '';
                    let explanationHtml = '';
                    let statusClass = '';

                    if (!item.studentAns) {
                        // UNANSWERED
                        statusClass = 'bg-gray-100 border border-gray-300 rounded p-2 mt-1';
                        statusHtml = '<span class="text-gray-500 font-bold italic">Student did not answer</span>';
                        explanationHtml = ''; // Hide correct answer and explanation
                    } else if (item.isCorrect) {
                        // CORRECT
                        statusClass = 'feedback-correct';
                        statusHtml = '<span class="text-green-700 font-bold">‚úì Correct</span>';
                        explanationHtml = '';
                    } else {
                        // INCORRECT
                        statusClass = 'feedback-incorrect';
                        statusHtml = '<span class="text-red-700 font-bold">‚úó Incorrect</span>';
                        explanationHtml = `<div class="text-xs mt-1"><b>Correct Answer:</b> ${item.a}<br><b>Explanation:</b> ${item.s}</div>`;
                    }

                    html += `
                        <div class="mb-4 pb-4 border-b border-gray-200 text-sm break-inside-avoid">
                            <p class="font-semibold mb-1">${idx + 1}. ${item.q}</p>
                            <div class="ml-4">
                                <p class="text-gray-600">Student Answer: <span class="font-mono font-bold">${item.studentAns || '(No Answer)'}</span></p>
                                <div class="${statusClass}">
                                    ${statusHtml}
                                    ${explanationHtml}
                                </div>
                            </div>
                        </div>
                    `;
                });

                html += `</div>`; 
            });

            const grandPct = overallTotal > 0 ? ((overallScore / overallTotal) * 100).toFixed(1) : 0;
            const overallLetter = getLetterGrade(grandPct);

            html += `
                <div class="mt-8 p-6 bg-blue-900 text-white rounded-xl text-center break-inside-avoid font-serif">
                    <h3 class="text-xl font-bold uppercase">Overall Performance</h3>
                    <div class="text-4xl font-extrabold mt-2">${overallScore} / ${overallTotal}</div>
                    <div class="text-2xl font-light mt-1">${grandPct}% - Rating: ${overallLetter}</div>
                </div>
            `;

            html += `
                <div class="print-footer">
                    <div class="footer-line-1">
                        <span class="text-left">FABM 1</span>
                        <span class="text-right">Page 1 of 1</span>
                    </div>
                    <div class="footer-line-2">
                        <div class="footer-box">4Cs: Christ-centeredness, Competence, Character, Compassion</div>
                    </div>
                </div>
            `;

            container.innerHTML = html;
        }

        window.downloadPDF = function() {
            const element = document.getElementById('print-content');
            const filename = `SummativeTest_${studentInfo.cn}_${studentInfo.gs}.pdf`;
            
            const opt = {
                margin: 0.5,
                filename: filename,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2, useCORS: true },
                jsPDF: { unit: 'in', format: [8.5, 13], orientation: 'portrait' }
            };

            html2pdf().set(opt).from(element).save();
        }

    </script>
</body>
</html>
