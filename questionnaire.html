<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Questionnaire</title>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAgOsKAZWwExUzupxSNytsfOo9BOppF0ng",
      authDomain: "jlvcpa-quizzes.firebaseapp.com",
      projectId: "jlvcpa-quizzes",
      storageBucket: "jlvcpa-quizzes.firebasestorage.app",
      messagingSenderId: "629158256557",
      appId: "1:629158256557:web:b3d1a424b32e28cd578b24"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>

  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f9f9f9;
      padding: 20px;
    }
    h1, h2 {
      text-align: center;
      color: #2c3e50;
    }
    #schoolLogo {
      max-height: 100px;
      margin-bottom: 10px;
    }
    .header {
      text-align: center;
      margin-bottom: 20px;
    }
    .info-block, .quiz-box {
      max-width: 800px;
      margin: 0 auto 20px;
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .quiz-title {
      text-align: center;
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 20px;
      color: #2c3e50;
    }
    .student-info {
      display: flex;
      justify-content: space-between;
      font-weight: bold;
      margin-bottom: 15px;
      gap: 20px;
      flex-wrap: wrap;
    }
    .grade-block p {
      margin: 10px 0;
    }
    textarea[readonly] {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      resize: none;
      border: 1px solid #ccc;
      border-radius: 4px;
      background-color: #f5f5f5;
    }
    .score {
      text-align: right;
      font-size: 16px;
      font-weight: bold;
      color: #28a745;
      margin-bottom: 10px;
    }
    .topic-label {
      font-size: 14px;
      color: #888;
      margin-bottom: 10px;
      font-style: italic;
    }
    .rubric-block h3 {
      margin-bottom: 10px;
      color: #007acc;
    }
    .rubric-table table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    .rubric-table th, .rubric-table td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
      vertical-align: top;
      font-size: 14px;
    }
    .rubric-table thead {
      background-color: #eef6fc;
      font-weight: bold;
    }
    .question-block h3 {
      margin-top: 0;
      color: #34495e;
    }
    .option {
      margin: 5px 0;
    }
    #navigation {
      text-align: center;
      margin-top: 20px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin: 5px;
      background-color: #007acc;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #005fa3;
    }
    #submitBtn {
      background-color: #28a745;
    }
    #submitBtn:hover {
      background-color: #218838;
    }
    #timer, #warningMessage, #viewedCounter, #result {
      text-align: center;
      margin-top: 10px;
      font-weight: bold;
    }
    #result {
      color: #28a745;
    }
  </style>
</head>
<body>

  <div class="header">
    <img id="schoolLogo" src="shs-adc.png" alt="School Logo"><br>
    <span style="color:#007acc; font-size:20px;">Senior High School Department</span><br>
    <span style="color:#000;">SY 2025–2026</span><br>
    <span style="color:#000;">2nd Semester</span><br>
    <span style="color:#000;">FABM 1</span>
  </div>

  <div class="info-block" id="quizHeader"></div>
  <div id="timer"></div>
  <div id="warningMessage"></div>
  <div class="quiz-box" id="quizContainer"></div>
  <div id="navigation">
    <button onclick="prevQuestion()">⬅ Previous</button>
    <button onclick="nextQuestion()">Next ➡</button>
    <button id="submitBtn" onclick="submitQuiz()">✅ Submit Quiz</button>
  </div>
  <div id="viewedCounter"></div>
  <div id="result"></div>
  <script>
  const params = new URLSearchParams(window.location.search);
  const studentId = params.get('student');
  const studentData = JSON.parse(localStorage.getItem(`questionnaire-${studentId}`));

  if (!studentData) {
    alert("Quiz data not found.");
    document.body.innerHTML = "<h2 style='text-align:center;'>⛔ Quiz not found or expired.</h2>";
  }

  const { cnNo, lastName, firstName, password, quizData } = studentData;

  const questionBank = [
    {
  competency: "Understand",
  topic: "History of Accounting",
  question: "Why was accounting important in ancient Egypt and Babylon?",
  options: [
    "To build pyramids",
    "To manage agricultural production and state wealth",
    "To trade with Rome",
    "To perform religious rituals"
  ],
  answer: "To manage agricultural production and state wealth",
  explanation: "✅ Accounting in ancient Egypt and Babylon was used to manage agricultural output and state resources, making it essential for economic control."
},
{
  competency: "Understand",
  topic: "History of Accounting",
  question: "What does the term 'ad rationes' suggest about Roman accounting?",
  options: [
    "It was a form of taxation",
    "It involved storytelling",
    "It referred to financial documentation",
    "It was a religious practice"
  ],
  answer: "It referred to financial documentation",
  explanation: "✅ 'Ad rationes' was the Roman term for documenting revenues and expenditures, showing their early use of financial records."
},
{
  competency: "Understand",
  topic: "History of Accounting",
  question: "How did temple economies contribute to accounting practices?",
  options: [
    "They ignored recordkeeping",
    "They used accounting for rituals",
    "They maintained meticulous records",
    "They traded with Babylon"
  ],
  answer: "They maintained meticulous records",
  explanation: "✅ Temple economies kept detailed records to manage offerings, resources, and operations, laying foundations for accounting systems."
},
{
  competency: "Understand",
  topic: "History of Accounting",
  question: "What role did accounting play in the Roman Empire?",
  options: [
    "It was used for entertainment",
    "It documented public revenues and expenditures",
    "It helped build roads",
    "It was used in warfare"
  ],
  answer: "It documented public revenues and expenditures",
  explanation: "✅ The Romans used accounting to track government income and spending, demonstrating its role in public administration."
},
{
  competency: "Understand",
  topic: "History of Accounting",
  question: "What does the evolution of accounting from temple economies to empires indicate?",
  options: [
    "Accounting became less important",
    "It shifted from agriculture to warfare",
    "It expanded in scope and complexity",
    "It was replaced by trade"
  ],
  answer: "It expanded in scope and complexity",
  explanation: "✅ Accounting evolved from managing temple resources to overseeing state finances, showing its growing importance and sophistication."
},
    {
  competency: "Remember",
  topic: "History of Accounting",
  question: "Which ancient civilizations practiced early accounting?",
  options: [
    "Greece and Rome",
    "Egypt and Babylon",
    "China and India",
    "Persia and Greece"
  ],
  answer: "Egypt and Babylon",
  explanation: "✅ Egypt and Babylon were among the earliest civilizations to use accounting for managing agricultural and temple resources."
},
{
  competency: "Remember",
  topic: "History of Accounting",
  question: "What was the Roman term for financial documentation?",
  options: [
    "Ad rationes",
    "De numeris",
    "Tabulae",
    "Scriptura"
  ],
  answer: "Ad rationes",
  explanation: "✅ 'Ad rationes' was the Latin term used by Romans to refer to their financial records and accounting practices."
},
{
  competency: "Remember",
  topic: "History of Accounting",
  question: "What did ancient accounting help manage?",
  options: [
    "Military campaigns",
    "Agricultural production and state wealth",
    "Religious ceremonies",
    "Trade routes"
  ],
  answer: "Agricultural production and state wealth",
  explanation: "✅ Early accounting systems were designed to manage agricultural yields and the wealth of the state."
},
{
  competency: "Remember",
  topic: "History of Accounting",
  question: "Which empire documented public revenues and expenditures?",
  options: [
    "Babylonian",
    "Egyptian",
    "Roman",
    "Greek"
  ],
  answer: "Roman",
  explanation: "✅ The Roman Empire used accounting to record public income and spending, a precursor to modern financial statements."
},
{
  competency: "Remember",
  topic: "History of Accounting",
  question: "What kind of economies used meticulous recordkeeping?",
  options: [
    "Temple economies",
    "Trade economies",
    "Nomadic economies",
    "Industrial economies"
  ],
  answer: "Temple economies",
  explanation: "✅ Temple economies required detailed records to manage offerings, resources, and operations, forming the basis of accounting."
},
    {
  competency: "Analyze",
  topic: "History of Accounting",
  question: "How did accounting practices reflect the priorities of ancient civilizations?",
  options: [
    "They focused on entertainment",
    "They emphasized religious rituals",
    "They prioritized resource management and governance",
    "They ignored documentation"
  ],
  answer: "They prioritized resource management and governance",
  explanation: "✅ Ancient accounting systems were designed to manage resources and support governance, reflecting societal priorities."
},
{
  competency: "Analyze",
  topic: "History of Accounting",
  question: "What does the use of 'ad rationes' in Rome suggest about their administrative sophistication?",
  options: [
    "They had no formal systems",
    "They relied on oral traditions",
    "They had structured financial records",
    "They used accounting for trade only"
  ],
  answer: "They had structured financial records",
  explanation: "✅ The Roman use of 'ad rationes' shows their advanced administrative systems and reliance on written financial documentation."
},
{
  competency: "Analyze",
  topic: "History of Accounting",
  question: "Why might temple economies have required meticulous recordkeeping?",
  options: [
    "To track donations",
    "To manage complex agricultural and religious operations",
    "To entertain priests",
    "To communicate with other temples"
  ],
  answer: "To manage complex agricultural and religious operations",
  explanation: "✅ Temples managed both spiritual and economic activities, requiring detailed records to ensure accountability and efficiency."
},
{
  competency: "Analyze",
  topic: "History of Accounting",
  question: "How does the evolution of accounting from Egypt to Rome illustrate its expanding role?",
  options: [
    "It became less relevant",
    "It shifted from agriculture to public finance",
    "It was used only in temples",
    "It focused on warfare"
  ],
  answer: "It shifted from agriculture to public finance",
  explanation: "✅ Accounting evolved from managing agricultural resources to overseeing public finances, showing its broader societal role."
},
{
  competency: "Analyze",
  topic: "History of Accounting",
  question: "What can we infer about the importance of accounting in ancient governance?",
  options: [
    "It was ceremonial",
    "It was central to managing resources and public funds",
    "It was used for entertainment",
    "It was rarely practiced"
  ],
  answer: "It was central to managing resources and public funds",
  explanation: "✅ Accounting was a key tool in ancient governance, enabling leaders to track and control economic activities."
},
    {
  competency: "Remember",
  topic: "History of Accounting",
  question: "Who is known as the 'Father of Accounting'?",
  options: [
    "Leonardo da Vinci",
    "Luca Pacioli",
    "Galileo Galilei",
    "Michelangelo"
  ],
  answer: "Luca Pacioli",
  explanation: "✅ Luca Pacioli is honored as the 'Father of Accounting' for documenting the double-entry system in 1494."
},
{
  competency: "Remember",
  topic: "History of Accounting",
  question: "What major work did Luca Pacioli publish in 1494?",
  options: [
    "Principia Mathematica",
    "Summa de Arithmetica",
    "Codex Atlanticus",
    "Liber Abaci"
  ],
  answer: "Summa de Arithmetica",
  explanation: "✅ Pacioli published 'Summa de Arithmetica' in 1494, which introduced the double-entry bookkeeping system to a wider audience."
},
{
  competency: "Remember",
  topic: "History of Accounting",
  question: "What century saw the introduction of the double-entry system?",
  options: [
    "13th century",
    "14th century",
    "15th century",
    "16th century"
  ],
  answer: "15th century",
  explanation: "✅ The double-entry system was introduced in the 15th century through Luca Pacioli’s work."
},
    {
  competency: "Understand",
  topic: "History of Accounting",
  question: "What is the core principle of the double-entry system?",
  options: [
    "Every transaction is recorded once",
    "Transactions are only recorded at year-end",
    "Every transaction affects at least two accounts",
    "Only cash transactions are recorded"
  ],
  answer: "Every transaction affects at least two accounts",
  explanation: "✅ The double-entry system ensures that each transaction impacts at least two accounts—debit and credit—providing balance and accuracy."
},
{
  competency: "Understand",
  topic: "History of Accounting",
  question: "Why was the double-entry system considered a breakthrough?",
  options: [
    "It simplified tax collection",
    "It allowed businesses to hide losses",
    "It prevented fraud and error while improving financial visibility",
    "It eliminated the need for accountants"
  ],
  answer: "It prevented fraud and error while improving financial visibility",
  explanation: "✅ The double-entry system helped prevent fraud and errors, giving businesses clearer insight into their finances."
},
{
  competency: "Understand",
  topic: "History of Accounting",
  question: "What was Luca Pacioli’s contribution to accounting?",
  options: [
    "He invented accounting",
    "He created tax laws",
    "He documented and popularized double-entry bookkeeping",
    "He designed accounting software"
  ],
  answer: "He documented and popularized double-entry bookkeeping",
  explanation: "✅ Pacioli didn’t invent double-entry bookkeeping, but his documentation made it foundational to modern accounting."
},
    {
  competency: "Analyze",
  topic: "History of Accounting",
  question: "How did Pacioli’s work influence modern accounting?",
  options: [
    "It introduced digital accounting",
    "It laid the foundation for systematic financial recording",
    "It replaced manual bookkeeping",
    "It focused only on personal finance"
  ],
  answer: "It laid the foundation for systematic financial recording",
  explanation: "✅ Pacioli’s documentation of double-entry bookkeeping established a structured approach that underpins modern accounting systems."
},
{
  competency: "Analyze",
  topic: "History of Accounting",
  question: "Why is Luca Pacioli celebrated despite not inventing double-entry bookkeeping?",
  options: [
    "He was the first to use it in banking",
    "He applied it to agriculture",
    "He formally documented and spread its use",
    "He created a new version of it"
  ],
  answer: "He formally documented and spread its use",
  explanation: "✅ Pacioli is honored because his work made double-entry bookkeeping widely known and adopted, shaping the future of accounting."
},
{
  competency: "Analyze",
  topic: "History of Accounting",
  question: "What impact did the double-entry system have on business operations?",
  options: [
    "It made accounting optional",
    "It reduced the need for financial reports",
    "It improved accuracy and accountability",
    "It focused only on inventory tracking"
  ],
  answer: "It improved accuracy and accountability",
  explanation: "✅ The double-entry system enhanced financial accuracy and accountability, helping businesses manage resources more effectively."
},
    {
  competency: "Remember",
  topic: "History of Accounting",
  question: "During which period did accounting scale up to meet industrial needs?",
  options: [
    "Renaissance",
    "Middle Ages",
    "Industrial Revolution",
    "Digital Age"
  ],
  answer: "Industrial Revolution",
  explanation: "✅ The Industrial Revolution marked a turning point where accounting expanded to support complex business operations."
},
{
  competency: "Remember",
  topic: "History of Accounting",
  question: "What type of accounting emerged during the Industrial Revolution?",
  options: [
    "Digital accounting",
    "Cost accounting",
    "Temple accounting",
    "Personal finance accounting"
  ],
  answer: "Cost accounting",
  explanation: "✅ Cost accounting developed during the Industrial Revolution to help businesses manage production expenses."
},
{
  competency: "Remember",
  topic: "History of Accounting",
  question: "Why did companies begin hiring specialized accountants during the Industrial Revolution?",
  options: [
    "To reduce taxes",
    "To manage complex operations",
    "To replace manual labor",
    "To handle customer service"
  ],
  answer: "To manage complex operations",
  explanation: "✅ As businesses grew more complex, companies needed specialized accountants to handle financial systems and operations."
},
    {
  competency: "Understand",
  topic: "History of Accounting",
  question: "How did the Industrial Revolution influence the evolution of accounting?",
  options: [
    "It made accounting obsolete",
    "It led to simpler financial systems",
    "It created demand for more robust financial systems",
    "It shifted accounting to religious institutions"
  ],
  answer: "It created demand for more robust financial systems",
  explanation: "✅ The expansion of commerce during the Industrial Revolution required stronger financial systems to support business growth."
},
{
  competency: "Understand",
  topic: "History of Accounting",
  question: "What was the purpose of developing auditing standards during the Industrial Revolution?",
  options: [
    "To entertain investors",
    "To reduce paperwork",
    "To support industrial growth and investor confidence",
    "To simplify tax filing"
  ],
  answer: "To support industrial growth and investor confidence",
  explanation: "✅ Auditing standards were introduced to ensure transparency and build trust among investors during rapid industrial expansion."
},
{
  competency: "Understand",
  topic: "History of Accounting",
  question: "What role did corporate accounting play during the Industrial Revolution?",
  options: [
    "It tracked religious donations",
    "It managed household budgets",
    "It supported large-scale business operations",
    "It replaced cost accounting"
  ],
  answer: "It supported large-scale business operations",
  explanation: "✅ Corporate accounting helped manage the financial complexity of growing industrial enterprises."
},
    {
  competency: "Analyze",
  topic: "History of Accounting",
  question: "Why was the emergence of specialized accountants significant during the Industrial Revolution?",
  options: [
    "It reduced the need for bookkeeping",
    "It allowed companies to expand globally",
    "It enabled businesses to handle complex financial operations",
    "It eliminated the need for financial reports"
  ],
  answer: "It enabled businesses to handle complex financial operations",
  explanation: "✅ Specialized accountants were essential for managing the intricate financial systems required by industrial-scale businesses."
},
{
  competency: "Analyze",
  topic: "History of Accounting",
  question: "How did accounting practices contribute to investor confidence during the Industrial Revolution?",
  options: [
    "By hiding financial losses",
    "By introducing cost-cutting measures",
    "By establishing transparent standards like auditing",
    "By reducing financial reporting"
  ],
  answer: "By establishing transparent standards like auditing",
  explanation: "✅ Auditing standards provided transparency and reliability, which were crucial for gaining investor trust in industrial enterprises."
},
{
  competency: "Analyze",
  topic: "History of Accounting",
  question: "What does the rise of corporate and cost accounting during the Industrial Revolution reveal about business needs?",
  options: [
    "Businesses preferred informal systems",
    "They needed detailed financial tracking and control",
    "They focused only on marketing",
    "They avoided financial documentation"
  ],
  answer: "They needed detailed financial tracking and control",
  explanation: "✅ The development of corporate and cost accounting shows that businesses required precise financial oversight to manage growth and complexity."
},
    {
  competency: "Remember",
  topic: "History of Accounting",
  question: "Which U.S. organization helped shape accounting standards in the 20th century?",
  options: [
    "SEC",
    "IRS",
    "AICPA",
    "FBI"
  ],
  answer: "AICPA",
  explanation: "✅ The American Institute of Certified Public Accountants (AICPA) played a key role in developing U.S. accounting standards."
},
{
  competency: "Remember",
  topic: "History of Accounting",
  question: "What does GAAP stand for?",
  options: [
    "Global Accounting and Audit Principles",
    "Generally Accepted Accounting Principles",
    "Government Approved Accounting Practices",
    "General Audit and Assurance Policies"
  ],
  answer: "Generally Accepted Accounting Principles",
  explanation: "✅ GAAP stands for Generally Accepted Accounting Principles, which guide financial reporting in the U.S."
},
{
  competency: "Remember",
  topic: "History of Accounting",
  question: "Which organization develops international accounting standards?",
  options: [
    "AICPA",
    "IASB",
    "SEC",
    "FASB"
  ],
  answer: "IASB",
  explanation: "✅ The International Accounting Standards Board (IASB) creates global standards like IFRS for consistent financial reporting."
},
    {
  competency: "Understand",
  topic: "History of Accounting",
  question: "What is the purpose of GAAP and IFRS?",
  options: [
    "To simplify tax filing",
    "To ensure consistent and reliable financial reporting",
    "To reduce accounting jobs",
    "To promote national accounting differences"
  ],
  answer: "To ensure consistent and reliable financial reporting",
  explanation: "✅ GAAP and IFRS provide standardized principles that help ensure financial statements are accurate and comparable across entities."
},
{
  competency: "Understand",
  topic: "History of Accounting",
  question: "How did accounting evolve in the 20th century?",
  options: [
    "It became less regulated",
    "It shifted to informal practices",
    "It adopted global frameworks and standards",
    "It focused only on local businesses"
  ],
  answer: "It adopted global frameworks and standards",
  explanation: "✅ The 20th century saw the rise of national and international bodies that established global accounting standards."
},
{
  competency: "Understand",
  topic: "History of Accounting",
  question: "Why are IFRS important for global businesses?",
  options: [
    "They reduce the need for audits",
    "They allow companies to avoid taxes",
    "They ensure financial statements are comparable across countries",
    "They eliminate the need for accountants"
  ],
  answer: "They ensure financial statements are comparable across countries",
  explanation: "✅ IFRS helps businesses present financial information in a way that is consistent and understandable across borders."
},
    {
  competency: "Analyze",
  topic: "History of Accounting",
  question: "How do global accounting standards like IFRS benefit international investors?",
  options: [
    "They simplify marketing strategies",
    "They reduce the need for financial reports",
    "They provide transparency and comparability",
    "They allow companies to hide losses"
  ],
  answer: "They provide transparency and comparability",
  explanation: "✅ IFRS ensures that financial statements are clear and consistent, helping investors make informed decisions across markets."
},
{
  competency: "Analyze",
  topic: "History of Accounting",
  question: "What does the emergence of organizations like IASB and AICPA suggest about accounting trends in the 20th century?",
  options: [
    "Accounting became decentralized",
    "There was a push for standardization and global consistency",
    "Accounting focused only on small businesses",
    "Financial reporting became optional"
  ],
  answer: "There was a push for standardization and global consistency",
  explanation: "✅ The rise of accounting bodies reflects a global effort to unify financial reporting practices for clarity and trust."
},
{
  competency: "Analyze",
  topic: "History of Accounting",
  question: "Why might businesses prefer using IFRS over local standards?",
  options: [
    "To avoid audits",
    "To appeal to international investors",
    "To reduce financial transparency",
    "To simplify payroll"
  ],
  answer: "To appeal to international investors",
  explanation: "✅ IFRS helps businesses present financials in a globally recognized format, attracting investors from different countries."
},
    {
  competency: "Remember",
  topic: "History of Accounting",
  question: "What law established the Board of Accountancy in the Philippines?",
  options: [
    "Presidential Decree No. 692",
    "Act No. 3105",
    "Republic Act No. 9298",
    "Executive Order No. 200"
  ],
  answer: "Act No. 3105",
  explanation: "✅ Act No. 3105 created the Board of Accountancy in 1923, laying the groundwork for regulation and licensing."
},
{
  competency: "Remember",
  topic: "History of Accounting",
  question: "When was PICPA founded?",
  options: [
    "1923",
    "1929",
    "1973",
    "1998"
  ],
  answer: "1929",
  explanation: "✅ The Philippine Institute of Certified Public Accountants (PICPA) was founded in 1929 to promote ethics and unity."
},
{
  competency: "Remember",
  topic: "History of Accounting",
  question: "Which decree reorganized the accounting profession in 1973?",
  options: [
    "Act No. 3105",
    "Presidential Decree No. 692",
    "Republic Act No. 9298",
    "Executive Order No. 200"
  ],
  answer: "PD No. 692",
  explanation: "✅ Presidential Decree No. 692 reorganized the accounting profession, strengthening the role of CPAs."
},
    {
  competency: "Understand",
  topic: "History of Accounting",
  question: "What was the purpose of establishing the Board of Accountancy?",
  options: [
    "To collect taxes",
    "To regulate and license accountants",
    "To promote business loans",
    "To manage government budgets"
  ],
  answer: "Regulate CPAs",
  explanation: "✅ The Board of Accountancy was created to regulate and license certified public accountants in the Philippines."
},
{
  competency: "Understand",
  topic: "History of Accounting",
  question: "How did PICPA support the accounting profession?",
  options: [
    "By offering tax services",
    "By promoting ethics and education",
    "By managing audits",
    "By creating financial software"
  ],
  answer: "Ethics & ed.",
  explanation: "✅ PICPA promoted ethical standards, continuing education, and professional unity among Filipino accountants."
},
{
  competency: "Understand",
  topic: "History of Accounting",
  question: "What was the impact of PD No. 692 on Philippine accounting?",
  options: [
    "It removed CPA exams",
    "It aligned standards internationally",
    "It privatized accounting firms",
    "It banned foreign auditors"
  ],
  answer: "Aligned intl.",
  explanation: "✅ PD No. 692 aligned Philippine accounting standards more closely with international practices."
},
    {
  competency: "Analyze",
  topic: "History of Accounting",
  question: "Why was the creation of PICPA significant for Filipino accountants?",
  options: [
    "It reduced CPA requirements",
    "It unified and uplifted the profession",
    "It focused on tax collection",
    "It replaced the Board of Accountancy"
  ],
  answer: "Unified CPAs",
  explanation: "✅ PICPA helped unify Filipino accountants and elevate the profession through ethics and education."
},
{
  competency: "Analyze",
  topic: "History of Accounting",
  question: "How did PD No. 692 strengthen the role of CPAs?",
  options: [
    "By removing licensing",
    "By increasing audit fees",
    "By formalizing standards and roles",
    "By limiting CPA practice"
  ],
  answer: "Formalized role",
  explanation: "✅ PD No. 692 reorganized the profession and formalized the role of CPAs in national and global contexts."
},
{
  competency: "Analyze",
  topic: "History of Accounting",
  question: "What do these milestones reveal about the evolution of accounting in the Philippines?",
  options: [
    "It became less regulated",
    "It focused only on taxes",
    "It grew in professionalism and global relevance",
    "It was limited to government use"
  ],
  answer: "Global growth",
  explanation: "✅ These milestones show how Philippine accounting evolved to support national development and global integration."
},
    {
  competency: "Remember",
  topic: "History of Accounting",
  question: "When was the Accounting Standards Council (ASC) established?",
  options: [
    "1973",
    "1981",
    "1995",
    "2001"
  ],
  answer: "1981",
  explanation: "✅ The ASC was established in November 1981 by PICPA to improve financial reporting standards in the Philippines."
},
{
  competency: "Remember",
  topic: "History of Accounting",
  question: "Which organization founded the ASC?",
  options: [
    "BOA",
    "SEC",
    "PICPA",
    "IASB"
  ],
  answer: "PICPA",
  explanation: "✅ PICPA founded the ASC to develop and promote generally accepted accounting principles in the Philippines."
},
{
  competency: "Remember",
  topic: "History of Accounting",
  question: "What reporting framework did ASC help develop?",
  options: [
    "GAAP",
    "IFRS",
    "PFRS",
    "BIR Code"
  ],
  answer: "PFRS",
  explanation: "✅ ASC laid the foundation for the Philippine Financial Reporting Standards (PFRS), which guide financial reporting today."
},
    {
  competency: "Understand",
  topic: "History of Accounting",
  question: "What was ASC’s primary mission?",
  options: [
    "To regulate taxes",
    "To train auditors",
    "To develop Philippine GAAP",
    "To manage CPA exams"
  ],
  answer: "PH GAAP",
  explanation: "✅ ASC’s mission was to develop and promote generally accepted accounting principles in the Philippines."
},
{
  competency: "Understand",
  topic: "History of Accounting",
  question: "How did ASC influence Philippine accounting standards?",
  options: [
    "By removing audit rules",
    "By aligning with IAS and IFRS",
    "By focusing on tax laws",
    "By banning foreign standards"
  ],
  answer: "Aligned intl.",
  explanation: "✅ ASC helped transition Philippine standards from U.S. GAAP to IAS and IFRS, improving global compatibility."
},
{
  competency: "Understand",
  topic: "History of Accounting",
  question: "Why was the shift to IFRS important for Filipino businesses?",
  options: [
    "It reduced reporting costs",
    "It simplified payroll",
    "It improved global transparency",
    "It removed audit requirements"
  ],
  answer: "Global clarity",
  explanation: "✅ Aligning with IFRS allowed Filipino businesses to present financial data more transparently to international stakeholders."
},
    {
  competency: "Analyze",
  topic: "History of Accounting",
  question: "What does ASC’s transition from U.S. GAAP to IFRS suggest about its goals?",
  options: [
    "To localize standards",
    "To simplify accounting",
    "To enhance global relevance",
    "To reduce CPA training"
  ],
  answer: "Global focus",
  explanation: "✅ ASC’s shift to IFRS shows its commitment to making Philippine financial reporting globally credible and consistent."
},
{
  competency: "Analyze",
  topic: "History of Accounting",
  question: "How did ASC’s work impact the credibility of Philippine financial reporting?",
  options: [
    "It made reports optional",
    "It improved transparency and trust",
    "It removed audit requirements",
    "It focused only on local firms"
  ],
  answer: "More trust",
  explanation: "✅ ASC’s standards helped Filipino businesses communicate financial information more transparently and credibly."
},
{
  competency: "Analyze",
  topic: "History of Accounting",
  question: "Why is PFRS considered a key outcome of ASC’s efforts?",
  options: [
    "It replaced tax codes",
    "It simplified accounting exams",
    "It became the core of PH reporting",
    "It eliminated audit rules"
  ],
  answer: "Core rules",
  explanation: "✅ PFRS, developed through ASC’s initiatives, remains the backbone of financial reporting in the Philippines today."
},
    {
  competency: "Remember",
  topic: "History of Accounting",
  question: "Which software is commonly used in modern accounting?",
  options: [
    "Photoshop",
    "QuickBooks",
    "Zoom",
    "Slack"
  ],
  answer: "QuickBooks",
  explanation: "✅ QuickBooks is one of the widely used accounting software tools that revolutionized bookkeeping and financial management."
},
{
  competency: "Remember",
  topic: "History of Accounting",
  question: "What type of accounting emerged to address environmental concerns?",
  options: [
    "Forensic accounting",
    "Sustainability accounting",
    "Crypto accounting",
    "Managerial accounting"
  ],
  answer: "Sustainability",
  explanation: "✅ Sustainability accounting focuses on tracking environmental and social impacts alongside financial performance."
},
{
  competency: "Remember",
  topic: "History of Accounting",
  question: "Which technology has transformed accounting in the digital era?",
  options: [
    "Typewriters",
    "Fax machines",
    "Cloud systems",
    "Whiteboards"
  ],
  answer: "Cloud systems",
  explanation: "✅ Cloud-based systems have revolutionized accounting by enabling real-time access, collaboration, and data security."
}, 
   {
  competency: "Understand",
  topic: "History of Accounting",
  question: "How has the role of accountants changed in the digital era?",
  options: [
    "They only do manual bookkeeping",
    "They focus on filing taxes",
    "They act as strategists and advisors",
    "They work only in banks"
  ],
  answer: "Strategists",
  explanation: "✅ Accountants today play strategic roles, offering insights and guidance beyond traditional number-crunching."
},
{
  competency: "Understand",
  topic: "History of Accounting",
  question: "What is forensic accounting used for?",
  options: [
    "Environmental audits",
    "Cryptocurrency tracking",
    "Investigating financial fraud",
    "Preparing tax returns"
  ],
  answer: "Fraud check",
  explanation: "✅ Forensic accounting is used to investigate financial discrepancies and support legal cases involving fraud."
},
{
  competency: "Understand",
  topic: "History of Accounting",
  question: "Why is crypto accounting becoming more relevant?",
  options: [
    "Because of declining cash use",
    "Due to growth in digital assets",
    "To replace traditional accounting",
    "To simplify payroll"
  ],
  answer: "Digital assets",
  explanation: "✅ Crypto accounting is emerging to manage and report on digital currencies and blockchain-based transactions."
},
    {
  competency: "Analyze",
  topic: "History of Accounting",
  question: "What does the rise of AI tools suggest about the future of accounting?",
  options: [
    "Manual work will increase",
    "AI will replace ethics",
    "Automation will enhance decision-making",
    "Accountants will only do data entry"
  ],
  answer: "Better decisions",
  explanation: "✅ AI tools help automate routine tasks and provide insights, allowing accountants to focus on strategic decision-making."
},
{
  competency: "Analyze",
  topic: "History of Accounting",
  question: "Why are emerging fields like sustainability and crypto accounting important?",
  options: [
    "They reduce audit costs",
    "They address new economic and social challenges",
    "They simplify traditional accounting",
    "They focus only on profit"
  ],
  answer: "New needs",
  explanation: "✅ These fields respond to evolving demands in transparency, ethics, and digital finance in the 21st century."
},
{
  competency: "Analyze",
  topic: "History of Accounting",
  question: "How has digital transformation impacted the accountant’s role?",
  options: [
    "It made accounting obsolete",
    "It limited their responsibilities",
    "It expanded their influence and responsibilities",
    "It removed the need for ethics"
  ],
  answer: "Expanded role",
  explanation: "✅ Digital tools have empowered accountants to take on broader roles in strategy, analysis, and governance."
}
    
    
  // ADD QUESTIONS ABOVE HERE
  ];    
  const selectedQuestions = questionBank
    .filter(q => quizData.topics.includes(q.topic))
    .sort(() => 0.5 - Math.random())
    .slice(0, quizData.num);

  let currentIndex = 0;
  let viewedIndexes = new Set();
  let responses = {};
  let timerInterval;
  const endTime = quizData.endTime;

  document.getElementById('quizHeader').innerHTML = `
    <div class="quiz-title">${quizData.title}</div>
    <div class="student-info">
      <div>CN NO: ${cnNo} — Name: ${lastName}, ${firstName}</div>
      <div>Grade Level and Section: ${quizData.section}</div>
    </div>
    <div class="grade-block">
      <p><strong>Test Type:</strong> ${quizData.type}</p>
      <p><strong>Instructions:</strong></p>
      <textarea readonly rows="4">${quizData.instructions}</textarea>
    </div>
    <div class="rubric-block">
      <h3>Rubric</h3>
      <div class="rubric-table">${quizData.rubric}</div>
    </div>
  `;

  // 🧾 Activity log storage
  const activityLog = [];
  let inactivityTimer;
  let warningTimer;
  let warningCountdown = 60;

  function logActivity(message) {
    const timestamp = new Date().toLocaleString();
    activityLog.push({ time: timestamp, message });
    localStorage.setItem('activityLog', JSON.stringify(activityLog));
  }

  function resetInactivityTimer() {
    clearTimeout(inactivityTimer);
    clearInterval(warningTimer);
    warningCountdown = 60;

    inactivityTimer = setTimeout(() => {
      showInactivityWarning();
    }, 2 * 60 * 1000);
  }

  function showInactivityWarning() {
    logActivity("⚠️ Inactivity warning triggered");

    warningTimer = setInterval(() => {
      if (warningCountdown <= 0) {
        clearInterval(warningTimer);
        logActivity("⏱️ Quiz refreshed due to inactivity");
        alert("Quiz is now refreshing due to inactivity.");
        location.reload();
      } else {
        alert(`⚠️ You’ve been inactive. Quiz will refresh in ${warningCountdown} seconds.`);
        warningCountdown -= 15;
      }
    }, 15 * 1000);
  }

  ['keydown', 'click', 'touchstart', 'mousemove'].forEach(event => {
    document.addEventListener(event, () => {
      logActivity(`🟢 ${event} detected`);
      resetInactivityTimer();
    });
  });

  resetInactivityTimer();

  window.addEventListener('load', () => {
    alert("📢 This quiz monitors keyboard, touch, and inactivity. If inactive for 3 minutes, it will refresh automatically.");
    logActivity("📢 Disclosure shown to student");
  });

  function startTimer() {
    timerInterval = setInterval(() => {
      const now = Date.now();
      const remaining = Math.max(0, Math.floor((endTime - now) / 1000));

      if (remaining <= 0) {
        clearInterval(timerInterval);
        submitQuiz();
      } else {
        const min = Math.floor(remaining / 60);
        const sec = remaining % 60;
        document.getElementById('timer').textContent =
          `⏱️ Time Remaining: ${min}:${sec.toString().padStart(2, '0')}`;
      }
    }, 1000);
  }

  function showQuestion(index) {
    const container = document.getElementById('quizContainer');
    const q = selectedQuestions[index];
    container.innerHTML = '';

    const topicLabel = document.createElement('div');
    topicLabel.className = 'topic-label';
    topicLabel.textContent = `Topic: ${q.topic}`;
    container.appendChild(topicLabel);

    const questionTitle = document.createElement('h3');
    questionTitle.textContent = `Q${index + 1}: ${q.question}`;
    container.appendChild(questionTitle);

    q.options.forEach(opt => {
      const label = document.createElement('label');
      label.className = 'option';
      const input = document.createElement('input');
      input.type = 'radio';
      input.name = `question${index}`;
      input.value = opt;
      input.checked = responses[index] === opt;
      input.onchange = () => {
        responses[index] = opt;
        updateWarning();
      };
      label.appendChild(input);
      label.appendChild(document.createTextNode(` ${opt}`));
      container.appendChild(label);
      container.appendChild(document.createElement('br'));
    });

    viewedIndexes.add(index);
    updateViewedCounter();
    updateWarning();
  }
</script>
<script>
  function nextQuestion() {
    if (!responses[currentIndex]) {
      document.getElementById('warningMessage').textContent =
        `⚠️ Question ${currentIndex + 1} has not been answered.`;
    }
    if (currentIndex < selectedQuestions.length - 1) {
      currentIndex++;
      showQuestion(currentIndex);
    }
  }

  function prevQuestion() {
    if (currentIndex > 0) {
      currentIndex--;
      showQuestion(currentIndex);
    }
  }

  function updateViewedCounter() {
    document.getElementById('viewedCounter').textContent =
      `${viewedIndexes.size} of ${selectedQuestions.length} questions viewed`;
  }

  function updateWarning() {
    const unanswered = [...viewedIndexes].filter(i => !responses[i]);
    if (unanswered.length > 0) {
      document.getElementById('warningMessage').textContent =
        `⚠️ Unanswered question(s): ${unanswered.map(i => i + 1).join(', ')}`;
    } else {
      document.getElementById('warningMessage').textContent = '';
    }
  }
    function submitQuiz() {
    // 🛡️ Prevent multiple submissions
    if (document.getElementById('navigation').style.display === 'none') return;

    clearInterval(timerInterval);

    let score = 0;
    const answeredOrder = Object.keys(responses).map(i => parseInt(i));
    answeredOrder.forEach(i => {
      if (responses[i] === selectedQuestions[i].answer) score++;
    });

    const percentage = Math.round((score / selectedQuestions.length) * 100);
    let grade = '';
    if (percentage >= 95) grade = 'A';
    else if (percentage >= 85) grade = 'P';
    else if (percentage >= 75) grade = 'D';
    else grade = 'IR';

    const resultWindow = window.open('', '_blank');
    resultWindow.document.write(`
      <!DOCTYPE html>
      <html lang="en">
      <head>
        <meta charset="UTF-8">
        <title>${quizData.title} - Completed Quiz</title>
        <style>
          body {
            font-family: 'Segoe UI', sans-serif;
            background: #fff;
            padding: 20px;
          }
          .header {
            text-align: center;
            margin-bottom: 20px;
          }
          #schoolLogo {
            max-height: 100px;
            margin-bottom: 10px;
          }
          .quiz-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #2c3e50;
          }
          .student-info {
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            margin-bottom: 10px;
          }
          .grade-block {
            text-align: right;
            font-weight: bold;
            font-size: 20px;
            color: #007acc;
          }
          .score {
            text-align: right;
            font-size: 16px;
            font-weight: bold;
            color: #28a745;
            margin-bottom: 10px;
          }
          .question-block {
            background: #f9f9f9;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            border-left: 5px solid #007acc;
          }
          .question-block h3 {
            margin-top: 0;
            color: #34495e;
          }
          .answer {
            margin-top: 10px;
            font-weight: bold;
            color: #333;
          }
          .correct {
            color: #28a745;
          }
          .incorrect {
            color: #d9534f;
          }
          textarea {
            width: 100%;
            margin-top: 10px;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
          }
          table, th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
          }
          .print-btn {
            text-align: center;
            margin-top: 20px;
          }
        </style>
      </head>
      <body>
        <div class="header">
          <img id="schoolLogo" src="shs-adc.png" alt="School Logo"><br>
          <span style="color:#007acc; font-size:20px;">Senior High School Department</span><br>
          <span style="color:#000;">SY 2025–2026</span><br>
          <span style="color:#000;">2nd Semester</span><br>
          <span style="color:#000;">FABM 1</span>
          <div class="quiz-title">${quizData.title}</div>
          <div class="grade-block">Grade: ${grade}</div>
          <div class="score">Score: ${score} / ${selectedQuestions.length} = ${percentage}%</div>
        </div>

        <div class="student-info">
          <div>CN NO: ${cnNo} — Name: ${lastName}, ${firstName}</div>
          <div>Section: ${quizData.section}</div>
        </div>

        <p><strong>Test Type:</strong> ${quizData.type}</p>
        <p><strong>Instructions:</strong></p>
        <textarea readonly rows="4">${quizData.instructions}</textarea>
        ${quizData.rubric}

        ${answeredOrder.map(i => {
          const q = selectedQuestions[i];
          const userAnswer = responses[i];
          const isCorrect = userAnswer === q.answer;
          const letterLabels = ['A', 'B', 'C', 'D'];
          const optionsHTML = q.options.map((opt, idx) => {
            const label = letterLabels[idx] || String.fromCharCode(65 + idx);
            return `<div style="margin-left:20px;">${label}. ${opt}</div>`;
          }).join('');
          const feedback = isCorrect
            ? `<div class="correct">Answered: ${letterLabels[q.options.indexOf(userAnswer)]} ✔</div>`
            : `<div class="incorrect">Answered: ${letterLabels[q.options.indexOf(userAnswer)]} ❌<br>Correct Answer: ${letterLabels[q.options.indexOf(q.answer)]}</div>`;
          return `
            <div class="question-block">
              <h3>${i + 1}. ${q.question}</h3>
              ${optionsHTML}
              ${feedback}
              <div class="explanation"><em>Explanation:</em> ${q.explanation || 'No explanation provided.'}</div>
            </div>
          `;
        }).join('')}

        <div class="print-btn">
          <button onclick="window.print()">🖨️ Print This Page</button>
        </div>
      </body>
      </html>
    `);

    resultWindow.document.close();

    const resultData = {
      cnNo,
      lastName,
      firstName,
      score,
      percentage,
      grade,
      responses,
      quizTitle: quizData.title,
      timestamp: Date.now()
    };

    localStorage.setItem(`result-${studentId}`, JSON.stringify(resultData));

    document.getElementById('navigation').style.display = 'none';
    document.getElementById('quizContainer').innerHTML = '<h3>✅ Quiz submitted. You may now close this page.</h3>';
  }

  window.onload = () => {
    startTimer();
    showQuestion(currentIndex);
  };
</script>
</body>
</html>
